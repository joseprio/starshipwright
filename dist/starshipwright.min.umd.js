!function(t,s){"object"==typeof exports&&"object"==typeof module?module.exports=s():"function"==typeof define&&define.amd?define([],s):"object"==typeof exports?exports.starshipwright=s():t.starshipwright=s()}(window,(function(){return function(t){var s={};function e(o){if(s[o])return s[o].exports;var r=s[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=s,e.d=function(t,s,o){e.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,s){if(1&s&&(t=e(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var r in t)e.d(o,r,function(s){return t[s]}.bind(null,r));return o},e.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(s,"a",s),s},e.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},e.p="",e(e.s=0)}([function(t,s,e){"use strict";e.r(s),e.d(s,"generateShip",(function(){return b}));class o{constructor(t){this.seedPosition=0,this.arrayPosition=0,this.hrCache={},this.seed=t,this.seed.length<8&&(this.seed="padding_"+this.seed),this.seed.length%2==0&&(this.seed="1"+this.seed),this.stateArray=[2972948403,3086140710,2071788248,3026137486,1411764137,2265725585,2923087685,1593177610],this.state=3234042090;for(var s=this.seed.length-1;s>=0;s--){var e=this.seed.charCodeAt(s);this.state=((this.state<<5)+this.state^e^this.state<<e%13+1^this.state>>e%17+1)>>>0,this.stateArray[s%8]^=((this.state>>9)*(this.state%16384+3427)^e)>>>0}}sr(){var t=this.seed.charCodeAt(this.seedPosition),s=this.stateArray[this.arrayPosition];return this.state=((this.state<<5)+this.state+s^t^this.state<<t%17+1^this.state>>t%13+1)>>>0,this.stateArray[this.arrayPosition]=(s>>3^s<<t%19+1^this.state%134217728*3427)>>>0,this.seedPosition=(this.seedPosition+1)%this.seed.length,this.arrayPosition=(this.arrayPosition+1)%8,this.state}hr_xorshift(t){const s=[1160605769,1424711319,876532818,1419174464];let e=1206170165;if(null==t&&(t="?/?/?/",e=3379896793),this.hrCache.hasOwnProperty(t))return this.hrCache[t];for(var o=t.length-1;o>=0;o--){const r=t.charCodeAt(o);let h=s[0]^r;h=(h^h<<11)>>>0,h=(h^h>>8)>>>0,s[0]=s[1],s[1]=s[2],s[2]=s[3],s[3]=(s[3]^s[3]>>19^h)>>>0,e=3427*(e^r<<24)^s[3]}for(var r=this.seed.length-1;r>=0;r--){const t=this.seed.charCodeAt(r);let o=s[0]^t;o=(o^o<<11)>>>0,o=(o^o>>8)>>>0,s[0]=s[1],s[1]=s[2],s[2]=s[3],s[3]=(s[3]^s[3]>>19^o)>>>0,e=3427*(e^t<<24)^s[3]}return this.hrCache[t]=e>>>0,this.hrCache[t]}sd(t,s){return(4294967296*this.sr()+this.sr())/0x10000000000000000*(s-t)+t}hd(t,s,e){return(4294967296*this.hr_xorshift(e)+this.hr_xorshift(e+"@"))/0x10000000000000000*(s-t)+t}si(t,s){return Math.floor((4294967296*this.sr()+this.sr())/0x10000000000000000*(s+1-t)+t)}hi(t,s,e){return Math.floor((4294967296*this.hr_xorshift(e)+this.hr_xorshift(e+"@"))/0x10000000000000000*(s+1-t)+t)}sb(t){return(4294967296*this.sr()+this.sr())/0x10000000000000000<t}hb(t,s){return(4294967296*this.hr_xorshift(s)+this.hr_xorshift(s+"@"))/0x10000000000000000<t}ss(t){return(4294967296*this.sr()+this.sr())/0x10000000000000000<t?-1:1}hs(t,s){return(4294967296*this.hr_xorshift(s)+this.hr_xorshift(s+"@"))/0x10000000000000000<t?-1:1}sseq(t,s){for(var e=0;(4294967296*this.sr()+this.sr())/0x10000000000000000<t&&e<s;)e++;return e}hseq(t,s,e){for(var o=0;(4294967296*this.hr_xorshift(e+o)+this.hr_xorshift(e+"@"+o))/0x10000000000000000<t&&o<s;)o++;return o}schoose(t){for(var s=0,e=0;e<t.length;e++)s+=t[e];for(var o=this.sd(0,s),r=0;r<t.length;r++)if((o-=t[r])<0)return r;return 0}hchoose(t,s){for(var e=0,o=0;o<t.length;o++)e+=t[o];for(var r=this.hd(0,e,s),h=0;h<t.length;h++)if((r-=t[h])<0)return h;return 0}}function r(t,s,e){return Math.max(s,Math.min(e,t))}function h(t,s){for(var e=Math.floor(t).toString(16);e.length<s;)e="0"+e;return e}function i(t){return"#"+h(Math.floor(255*r(t[0],0,1)),2)+(h(Math.floor(255*r(t[1],0,1)),2)+h(Math.floor(255*r(t[2],0,1)),2))}function c(t,s){return[t[0]*s,t[1]*s,t[2]*s]}function a(t){var s=t[1]*t[2],e=t[2]-s,o=6*((t[0]%1+1)%1),r=Math.floor(o),h=s*(1-Math.abs(o%2-1));switch(r){case 0:return[s+e,h+e,e];case 1:return[h+e,s+e,e];case 2:return[e,s+e,h+e];case 3:return[e,h+e,s+e];case 4:return[h+e,e,s+e];default:return[s+e,e,h+e]}}class n{constructor(t){this.componentChances=[],this.colors=[],this.colorChances=[],this.seed=t,this.r=new o(this.seed),this.cache={},this.setupComponentChances(),this.setupColors()}setupComponentChances(){this.componentChances=[];this.componentChances[0]=.8*this.r.sd(.001,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[1]=.9*this.r.sd(.01,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[2]=1*this.r.sd(.001,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[3]=3*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[4]=.5*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[5]=.05*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[6]=.5*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8))}setupColors(){const t=1+(this.r.hb(.7,"base color +1")?1:0)+this.r.hseq(.3,3,"base color count");for(let s=0;s<t;s++){const t="base color"+s;this.colors.push(a([Math.pow(this.r.hd(0,1,t+"hue"),2),r(this.r.hd(-.2,1,t+"saturation"),0,Math.pow(this.r.hd(0,1,t+"saturation bound"),4)),r(this.r.hd(.7,1.1,t+"value"),0,1)])),this.colorChances.push(Math.pow(2,this.r.hd(0,6,t+"chances")))}}getBaseColor(t){let s=this.colors[t.r.schoose(this.colorChances)];return t.r.sb(Math.pow(this.r.hd(0,.5,"base color shift chance"),2))&&(s=[s[0],s[1],s[2]],s[0]=r(s[0]+Math.pow(this.r.hd(0,.6,"base color shift range red"),2)*r(t.r.sd(-1,1.2),0,1)*r(t.r.ss(.7)+t.r.ss(.7),-1,1),0,1),s[1]=r(s[1]+Math.pow(this.r.hd(0,.6,"base color shift range green"),2)*r(t.r.sd(-1,1.2),0,1)*r(t.r.ss(.7)+t.r.ss(.7),-1,1),0,1),s[2]=r(s[2]+Math.pow(this.r.hd(0,.6,"base color shift range blue"),2)*r(t.r.sd(-1,1.2),0,1)*r(t.r.ss(.7)+t.r.ss(.7),-1,1),0,1)),s}}function l(t,s){return 1-s[1]/t.h}function f(t,s,e,o){let r=1;return e&&(r=Math.min(r,1-Math.abs(s[0]-t.hw)/t.hw)),o&&(r=Math.min(r,1-Math.abs(s[1]-t.hh)/t.hh)),r}function d(t,s){return f(t,s,!0,!0)*(1-1/((t.w+t.h)/1e3+1))*Math.pow(t.f.r.hd(0,1,"master bigness"),.5)*(1-t.getpcdone())}function x(t,s){return[Math.min(s[0][0]-24,t.w-24-s[1][0]),Math.min(s[0][1]-24,t.h-24-s[1][1])]}function u(t,s,e,o){const h=t.cfx.createLinearGradient(e[0],e[1],2*s[0]-e[0],2*s[1]-e[1]),i=function(t){return"rgba(0,0,0,"+r(t,0,1)+")"}(o);return h.addColorStop(0,i),h.addColorStop(.5,"rgba(0,0,0,0)"),h.addColorStop(1,i),h}const M=[];M[0]=function(t,s){let e=8;const o=Math.pow(d(t,s),.3);if(t.r.sb(t.f.r.hd(0,.9,"com0 bigchance")*o)){const r=t.f.r.hd(0,.5,"com0 bigincchance");for(;t.r.sb(r*o);){const o=x(t,[[s[0]-e,s[1]-e],[s[0]+e,s[1]+e]]);if(!(Math.min(o[0],o[1])>.5*e))break;e*=1.5}}const h=2*e,a=[Math.ceil(t.r.sd(1,Math.max(2,.5*e))),Math.ceil(t.r.sd(1,Math.max(2,.5*e)))],n=Math.min(a[0],a[1])*t.r.sd(.1,1.2),l=[a[0]+2*n,a[1]+2*n],f=[Math.ceil(h/l[0]),Math.ceil(h/l[1])],M=[Math.round(f[0]*l[0]/2),Math.round(f[1]*l[1]/2)],g=t.getpcdone(),p=t.f.getBaseColor(t),m=i(c(p,t.r.sd(.4,1))),w=i(c(p,t.r.sd(.4,1)));t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.25)+")",t.cfx.fillRect(s[0]-M[0]-1,s[1]-M[1]-1,l[0]*f[0]+2,l[1]*f[1]+2),t.cfx.fillStyle=w,t.cfx.fillRect(s[0]-M[0],s[1]-M[1],l[0]*f[0],l[1]*f[1]),t.cfx.fillStyle=m;for(let e=0;e<f[0];e++){const o=s[0]+n+e*l[0]-M[0];for(let e=0;e<f[1];e++){const r=s[1]+n+e*l[1]-M[1];t.cfx.fillRect(o,r,a[0],a[1])}}t.r.sb(r(e/8*(.6*g+.3),0,.98))&&(t.cfx.fillStyle=u(t,s,[s[0]+M[0],s[1]],t.r.sd(0,.9)),t.cfx.fillRect(s[0]-M[0],s[1]-M[1],l[0]*f[0],l[1]*f[1]))},M[1]=function(t,s){let e=8;const o=Math.pow(d(t,s),.2);if(t.r.sb(t.f.r.hd(.3,1,"com1 bigchance")*o)){const r=t.f.r.hd(0,.6,"com1 bigincchance");for(;t.r.sb(r*o);){const o=x(t,[[s[0]-e,s[1]-e],[s[0]+e,s[1]+e]]);if(!(Math.min(o[0],o[1])>.5*e))break;e*=1.5}}let h=Math.ceil(t.r.sd(.8,2)*e);const a=Math.ceil(t.r.sd(.8,2)*e),n=t.r.si(3,Math.max(4,h)),l=Math.max(1,Math.round(h/n));h=l*n;const f=i(c(t.f.getBaseColor(t),t.r.sd(.5,1))),M=t.r.sd(.3,.9);if(t.r.sb(r(t.f.r.hd(-.2,1.2,"com1 hchance"),0,1))){const e=[s[0]-Math.floor(h/2),s[1]-Math.floor(a/2)];t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.25)+")",t.cfx.fillRect(e[0]-1,e[1]-1,h+2,a+2),t.cfx.fillStyle=f,t.cfx.fillRect(e[0],e[1],h,a);for(let o=0;o<l;o++)t.cfx.fillStyle=u(t,[e[0]+(o+.5)*n,s[1]],[e[0]+o*n,s[1]],M),t.cfx.fillRect(e[0]+o*n,e[1],n,a)}else{const e=[s[0]-Math.floor(a/2),s[1]-Math.floor(h/2)];t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.25)+")",t.cfx.fillRect(e[0]-1,e[1]-1,a+2,h+2),t.cfx.fillStyle=f,t.cfx.fillRect(e[0],e[1],a,h);for(let o=0;o<l;o++)t.cfx.fillStyle=u(t,[s[0],e[1]+(o+.5)*n],[s[0],e[1]+o*n],M),t.cfx.fillRect(e[0],e[1]+o*n,h,n)}},M[2]=function(t,s){let e=8;const o=Math.pow(d(t,s),.05);if(t.r.sb(t.f.r.hd(0,1,"com2 bigchance")*o)){const r=t.f.r.hd(0,.9,"com2 bigincchance");for(;t.r.sb(r*o);){const o=x(t,[[s[0]-e,s[1]-e],[s[0]+e,s[1]+e]]);if(!(Math.min(o[0],o[1])>.5*e))break;e*=1.5}}const h=Math.ceil(t.r.sd(.6,1.4)*e),a=Math.ceil(t.r.sd(1,2)*e),n=[Math.ceil(r(h*t.r.sd(.7,1)/2,1,h)),Math.ceil(r(h*t.r.sd(.8,1)/2,1,h))],l=[Math.floor(r(h*t.r.sd(.05,.25),1,a)),Math.floor(r(h*t.r.sd(.1,.3),1,a))],f=l[0]+l[1],u=t.r.sb(Math.pow(t.f.r.hd(0,1,"com2 oddchance"),.5)),M=r(Math.floor(a/f),1,a),g=M*f+(u?l[0]:0),p=t.f.getBaseColor(t),m=[c(p,t.r.sd(.6,1)),c(p,t.r.sd(.6,1))],w=1-t.r.sd(.5,.95),b=[c(m[0],w),c(m[1],w)];if(t.r.sb(Math.pow(t.f.r.hd(0,1,"com2 verticalchance"),.1))){const e=[t.cfx.createLinearGradient(s[0]-n[0],s[1],s[0]+n[0],s[1]),t.cfx.createLinearGradient(s[0]-n[1],s[1],s[0]+n[1],s[1])];e[0].addColorStop(0,i(b[0])),e[0].addColorStop(.5,i(m[0])),e[0].addColorStop(1,i(b[0])),e[1].addColorStop(0,i(b[1])),e[1].addColorStop(.5,i(m[1])),e[1].addColorStop(1,i(b[1]));const o=Math.floor(s[1]-g/2);for(let r=0;r<M;r++)t.cfx.fillStyle=e[0],t.cfx.fillRect(s[0]-n[0],o+r*f,2*n[0],l[0]),t.cfx.fillStyle=e[1],t.cfx.fillRect(s[0]-n[1],o+r*f+l[0],2*n[1],l[1]);u&&(t.cfx.fillStyle=e[0],t.cfx.fillRect(s[0]-n[0],o+M*f,2*n[0],l[0]))}else{const e=[t.cfx.createLinearGradient(s[0],s[1]-n[0],s[0],s[1]+n[0]),t.cfx.createLinearGradient(s[0],s[1]-n[1],s[0],s[1]+n[1])];e[0].addColorStop(0,i(b[0])),e[0].addColorStop(.5,i(m[0])),e[0].addColorStop(1,i(b[0])),e[1].addColorStop(0,i(b[1])),e[1].addColorStop(.5,i(m[1])),e[1].addColorStop(1,i(b[1]));const o=Math.floor(s[0]-g/2);for(let r=0;r<M;r++)t.cfx.fillStyle=e[0],t.cfx.fillRect(o+r*f,s[1]-n[0],l[0],2*n[0]),t.cfx.fillStyle=e[1],t.cfx.fillRect(o+r*f+l[0],s[1]-n[1],l[1],2*n[1]);u&&(t.cfx.fillStyle=e[0],t.cfx.fillRect(o+M*f,s[1]-n[0],l[0],2*n[0]))}},M[3]=function(t,s){if(t.r.sb(l(t,s)-.3)||t.getcellstate(s[0],s[1]+6*1.2)>0||t.getcellstate(s[0],s[1]+10.8)>0)for(let e=0;e<100;e++){const e=t.r.schoose(t.f.componentChances);if(3!=e)return void M[e](t,s)}let e=8;const o=Math.pow(d(t,s),.1);if(t.r.sb(t.f.r.hd(.6,1,"com3 bigchance")*o)){const r=t.f.r.hd(.3,.8,"com3 bigincchance");for(;t.r.sb(r*o);){const o=x(t,[[s[0]-e,s[1]-e],[s[0]+e,s[1]+e]]);if(!(Math.min(o[0],o[1])>.5*e))break;e*=1.5}}const r=t.r.sd(1,2)*e;let h=Math.ceil(t.r.sd(.3,1)*e);const a=r*t.r.sd(.25,.6),n=(r+a)/2/2,f=[Math.max(1,Math.ceil(h*t.r.sd(.08,.25))),Math.max(1,Math.ceil(h*t.r.sd(.03,.15)))],u=f[0]+f[1],g=Math.ceil(h/u);h=g*u+f[0],t.f.setupColors();const p=t.f.colors[t.f.r.hchoose(t.f.colorChances,"com3 basecolor")],m=t.f.r.hd(.5,.8,"com3 lightness0 mid"),w=m-t.f.r.hd(.2,.4,"com3 lightness0 edge"),b=t.f.r.hd(0,.2,"com3 lightness1 edge"),C=[t.cfx.createLinearGradient(s[0]-n,s[1],s[0]+n,s[1]),t.cfx.createLinearGradient(s[0]-n,s[1],s[0]+n,s[1])];C[0].addColorStop(0,i(c(p,w))),C[0].addColorStop(.5,i(c(p,m))),C[0].addColorStop(1,i(c(p,w))),C[1].addColorStop(0,i(c(p,b))),C[1].addColorStop(.5,i(p)),C[1].addColorStop(1,i(c(p,b)));const y=Math.ceil(s[1]-h/2);t.cfx.fillStyle=C[0],t.cfx.beginPath(),t.cfx.moveTo(s[0]-a/2,y),t.cfx.lineTo(s[0]+a/2,y),t.cfx.lineTo(s[0]+r/2,y+h),t.cfx.lineTo(s[0]-r/2,y+h),t.cfx.fill(),t.cfx.fillStyle=C[1];const S=[y+f[0],y+u];for(let e=0;e<g;e++){const o=[e*u+f[0],(e+1)*u],i=[S[0]+e*u,S[1]+e*u],c=[(a+(r-a)*(o[0]/h))/2,(a+(r-a)*(o[1]/h))/2];t.cfx.beginPath(),t.cfx.moveTo(s[0]-c[0],i[0]),t.cfx.lineTo(s[0]+c[0],i[0]),t.cfx.lineTo(s[0]+c[1],i[1]),t.cfx.lineTo(s[0]-c[1],i[1]),t.cfx.fill()}},M[4]=function(t,s){const e=f(t,s,!0,!1),o=t.r.sd(.7,1),r=t.r.sd(0,.2),h=t.f.getBaseColor(t),a=i(c(h,o)),n=i(c(h,r));null==t.f.cache["com4 directionc"]&&(t.f.cache["com4 directionc"]=[1*Math.pow(t.f.r.hd(0,1,"com4 directionc0"),4),.1*Math.pow(t.f.r.hd(0,1,"com4 directionc1"),4),.2*Math.pow(t.f.r.hd(0,1,"com4 directionc2"),4)]);const l=Math.max(3,Math.ceil(t.size*Math.pow(t.r.sd(.4,1),2)*t.f.r.hd(.02,.1,"com4 maxwidth"))),d=Math.floor(l/2),x=l%2,u=t.r.schoose([t.f.cache["com4 directionc"][0]*(2-e),t.f.cache["com4 directionc"][1],t.f.cache["com4 directionc"][2]*(1+e)]);let g=null;if(0==u){const e=s[1]-24,o=Math.min(Math.max(8,e-t.r.si(0,16)),Math.floor(.7*t.size*Math.pow(t.r.sd(0,1),t.f.r.hd(2,6,"com4 hpower0")))),r=[[s[0]-d,s[1]-o],[s[0]+d+x,s[1]]],h=t.cfx.createLinearGradient(r[0][0],r[0][1],r[1][0],r[0][1]);h.addColorStop(0,n),h.addColorStop(.5,a),h.addColorStop(1,n),t.cfx.fillStyle=h,t.cfx.fillRect(r[0][0],r[0][1],l,o),g=[s[0],s[1]-o]}else if(1==u){const e=t.h-(24+s[1]),o=Math.min(Math.max(8,e-t.r.si(0,16)),Math.floor(.6*t.size*Math.pow(t.r.sd(0,1),t.f.r.hd(2,7,"com4 hpower1")))),r=[[s[0]-d,s[1]],[s[0]+d+x,s[1]+o]],h=t.cfx.createLinearGradient(r[0][0],r[0][1],r[1][0],r[0][1]);h.addColorStop(0,n),h.addColorStop(.5,a),h.addColorStop(1,n),t.cfx.fillStyle=h,t.cfx.fillRect(r[0][0],r[0][1],l,o),g=[s[0],s[1]+o]}else if(2==u){const e=t.cfx.createLinearGradient(s[0],s[1]-d,s[0],s[1]+d+x);e.addColorStop(0,n),e.addColorStop(.5,a),e.addColorStop(1,n),t.cfx.fillStyle=e,t.cfx.fillRect(s[0],s[1]-d,Math.ceil(t.hw-s[0])+1,l),g=[Math.floor(t.hw),s[1]]}if(null==t.f.cache["com4 covercomc"]&&(t.f.cache["com4 covercomc"]=[.6*Math.pow(t.f.r.hd(0,1,"com4 covercomc0"),2),.2*Math.pow(t.f.r.hd(0,1,"com4 covercomc1"),2),1*Math.pow(t.f.r.hd(0,1,"com4 covercomc2"),2)]),M[t.r.schoose(t.f.cache["com4 covercomc"])](t,s),t.getcellstate(g[0],g[1])>0){const s=[g[0]+Math.round(6*t.r.sd(-1,1)),g[1]+Math.round(6*t.r.sd(-1,1))];t.getcellstate(s[0],s[1])>0?M[t.r.schoose(t.f.cache["com4 covercomc"])](t,s):M[t.r.schoose(t.f.cache["com4 covercomc"])](t,g)}},M[5]=function(t,s){let e=8;const o=Math.pow(d(t,s),.1);if(t.r.sb(t.f.r.hd(0,.9,"com5 bigchance")*o)){const r=t.f.r.hd(0,.8,"com5 bigincchance");for(;t.r.sb(r*o);){const o=x(t,[[s[0]-e,s[1]-e],[s[0]+e,s[1]+e]]);if(!(Math.min(o[0],o[1])>.5*e))break;e*=1.5}}const r=t.r.sd(.75,1),h=t.r.sd(0,.25),a=t.f.getBaseColor(t),n=i(c(a,r)),l=i(c(a,h)),f=1+t.r.sseq(t.f.r.hd(0,1,"com5 multxc"),Math.floor(1.2*Math.pow(e/8,.6))),u=1+t.r.sseq(t.f.r.hd(0,1,"com5 multyc"),Math.floor(1.2*Math.pow(e/8,.6))),M=t.r.sd(.5,1)*e/Math.max(f,u),g=M+.5,p=M+1,m=.2*M,w=M*f,b=M*u,C=[s[0]-w,s[1]-b];t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.2)+")";for(let s=0;s<f;s++){const e=C[0]+(2*s+1)*M;for(let s=0;s<u;s++){const o=C[1]+(2*s+1)*M;t.cfx.beginPath(),t.cfx.arc(e,o,p,0,2*Math.PI),t.cfx.fill()}}for(let s=0;s<f;s++){const e=C[0]+(2*s+1)*M;for(let s=0;s<u;s++){const o=C[1]+(2*s+1)*M,r=t.cfx.createRadialGradient(e,o,m,e,o,g);r.addColorStop(0,n),r.addColorStop(1,l),t.cfx.fillStyle=r,t.cfx.beginPath(),t.cfx.arc(e,o,g,0,2*Math.PI),t.cfx.fill()}}},M[6]=function(t,s){if(t.nextpass<=0||t.r.sb(l(t,s)))return void M[t.r.schoose(function(t,s,e){const o=new Array(e-s);for(let r=e;r>=s;r--)o[r-s]=t[r];return o}(t.f.componentChances,0,5))](t,s);let e=8;const o=Math.pow(d(t,s),.05);if(t.r.sb(t.f.r.hd(0,.9,"com6 bigchance")*o)){const r=t.f.r.hd(0,.8,"com6 bigincchance");for(;t.r.sb(r*o);){const o=x(t,[[s[0]-e,s[1]-e],[s[0]+e,s[1]+e]]);if(!(Math.min(o[0],o[1])>.5*e))break;e*=1.5}}const r=Math.ceil(2*e*t.r.sd(.6,1)),h=Math.floor(r/2),a=r%2,n=r*Math.pow(t.r.sd(Math.pow(t.f.r.hd(0,.8,"com6 h1min"),.5),.9),t.f.r.hd(.5,1.5,"com6 h1power")),f=Math.floor(n/2),u=r%2,g=Math.max(0-(r-n)/2,r*(t.r.sd(0,.45)+t.r.sd(0,.45))*(null==t.f.cache["com6 backness"]?t.f.cache["com6 backness"]=t.f.r.hb(.8,"com6 backnesstype")?t.f.r.hd(.2,.9,"com6 backness#pos"):t.f.r.hd(-.2,-.05,"com6 backness#neg"):t.f.cache["com6 backness"])),p=Math.ceil(e*t.r.sd(.7,1)*Math.pow(t.f.r.hd(.1,3.5,"com6 width"),.5)),m=Math.floor(p/2),w=p%2,b=[[s[0]-m,s[1]+g-f],[s[0]+m+w,s[1]-h],[s[0]+m+w,s[1]+h+a],[s[0]-m,s[1]+g+f+u]],C=t.f.getBaseColor(t);t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.2)+")",t.cfx.beginPath(),t.cfx.moveTo(b[0][0]-1,b[0][1]),t.cfx.lineTo(b[1][0]-1,b[1][1]),t.cfx.lineTo(b[2][0]-1,b[2][1]),t.cfx.lineTo(b[3][0]-1,b[3][1]),t.cfx.fill(),t.cfx.fillStyle=i(c(C,t.r.sd(.7,1))),t.cfx.beginPath(),t.cfx.moveTo(b[0][0],b[0][1]),t.cfx.lineTo(b[1][0],b[1][1]),t.cfx.lineTo(b[2][0],b[2][1]),t.cfx.lineTo(b[3][0],b[3][1]),t.cfx.fill()};const g=[];g[0]=function(t){for(var s=.05*((t.w-48)*(t.h-48)),e=Math.ceil((t.w-48)*t.f.r.hd(.1,1,"outline0 iw")*.2),o=[[[t.hw-e,24],[t.hw+e,t.h-24]]],h=2+Math.floor(t.r.sd(.5,1)*t.f.r.hd(2,8,"outline0 bc")*Math.sqrt(t.size)),i=1;i<h;i++){var c=o[t.r.si(0,o.length-1)],a=[c[0][0]+t.r.sd(0,1)*(c[1][0]-c[0][0]),c[0][1]+t.r.sd(0,1)*(c[1][1]-c[0][1])];a[1]<.5*(c[0][1]+c[1][1])&&t.r.sb(t.f.r.hd(.5,1.5,"outline0 frontbias"))&&(a[1]=c[1][1]-(a[1]-c[0][1]));var n=[r(t.r.sd(0,1)*t.w,24,t.w-24),r(t.r.sd(0,1)*t.h,24,t.h-24)],l=s/Math.abs((n[0]-a[0])*(n[1]-a[1]));if(l<1&&(n[0]=a[0]+(n[0]-a[0])*l,n[1]=a[1]+(n[1]-a[1])*l),a[0]>n[0]){var f=a[0];a[0]=n[0],n[0]=f}if(a[1]>n[1]){f=a[1];a[1]=n[1],n[1]=f}o.push([[Math.floor(a[0]),Math.floor(a[1])],[Math.ceil(n[0]),Math.ceil(n[1])]])}t.csx.fillStyle="#FFFFFF";for(i=0;i<o.length;i++){var d=o[i];t.csx.fillRect(d[0][0],d[0][1],d[1][0]-d[0][0],d[1][1]-d[0][1]),t.csx.fillRect(t.w-d[1][0],d[0][1],d[1][0]-d[0][0],d[1][1]-d[0][1])}},g[1]=function(t){for(var s=.05*((t.w-48)*(t.h-48)),e=Math.max(2,Math.sqrt(s/Math.PI)),o=Math.ceil((t.w-48)*t.f.r.hd(.1,1,"outline1 iw")*.2),r=[],h=Math.floor((t.h-48)/(2*o)),i=0;i<h;i++){let s=[t.hw,t.h-(24+o*(2*i+1))];r.push({v:s,r:o})}var c=h+Math.floor(t.r.sd(.5,1)*t.f.r.hd(10,50,"outline1 cc")*Math.sqrt(t.size));for(i=h;i<c;i++){var a=r[Math.max(t.r.si(0,r.length-1),t.r.si(0,r.length-1))],n=t.r.sd(1,e),l=t.r.sd(Math.max(0,a.r-n),a.r);if((f=t.r.sd(0,2*Math.PI))>Math.PI&&t.r.sb(t.f.r.hd(.5,1.5,"outline1 frontbias")))var f=t.r.sd(0,Math.PI);let s=[a.v[0]+Math.cos(f)*l,a.v[1]+Math.sin(f)*l];n=Math.min(n,s[0]-24),n=Math.min(n,t.w-24-s[0]),n=Math.min(n,s[1]-24),n=Math.min(n,t.h-24-s[1]),r.push({v:s,r:n})}t.csx.fillStyle="#FFFFFF";for(let s=0;s<r.length;s++){const e=r[s];t.csx.beginPath(),t.csx.arc(e.v[0],e.v[1],e.r,0,2*Math.PI),t.csx.fill(),t.csx.beginPath(),t.csx.arc(t.w-e.v[0],e.v[1],e.r,0,2*Math.PI),t.csx.fill()}},g[2]=function(t){var s=[t.w-48,t.h-48],e=[[t.hw,t.r.sd(0,.05)*s[1]+24],[t.hw,t.r.sd(.95,1)*s[1]+24]],o=6/t.size+t.f.r.hd(.03,.1,"outline2 basefatness"),r=1/o,h=Math.max(3,Math.ceil(r*t.r.sd(.05,.1)*Math.sqrt(t.size)));t.csx.lineCap=["round","square"][t.f.r.hi(0,1,"outline2 linecap")],t.csx.strokeStyle="#FFFFFF";for(var i=1;i<h;i++){var c=e[i];null==c&&(c=[t.r.sd(0,1)*s[0]+24,Math.pow(t.r.sd(0,1),t.f.r.hd(.1,1,"outline2 frontbias"))*s[1]+24],e.push(c));for(var a=1+t.r.sseq(t.f.r.hd(0,1,"outline2 conadjust"),3),n=0;n<a;n++){var l=e[t.r.si(0,e.length-2)];t.csx.lineWidth=t.r.sd(.7,1)*o*t.size,t.csx.beginPath(),t.csx.moveTo(l[0],l[1]),t.csx.lineTo(c[0],c[1]),t.csx.stroke(),t.csx.beginPath(),t.csx.moveTo(t.w-l[0],l[1]),t.csx.lineTo(t.w-c[0],c[1]),t.csx.stroke()}}};class p{constructor(t,s,e){this.extradone=0,this.nextpass=0,this.nextcell=0,this.totaldone=0,this.f=t,this.baseSeed=s,this.seed=this.f.seed+this.baseSeed,this.r=new o(this.seed),this.size=null==e?Math.pow(this.r.sd(this.f.r.hd(2.5,3.5,"size min"),this.f.r.hd(5,7,"size max")),3):e;const r=this.r.sd(this.f.r.hd(.5,1,"wratio min"),this.f.r.hd(1,1.3,"wratio max")),h=this.r.sd(this.f.r.hd(.7,1,"hratio min"),this.f.r.hd(1.1,1.7,"hratio max"));this.w=Math.floor(this.size*r)+48,this.hw=Math.floor(this.w/2),this.gw=Math.floor((this.w-48)/6),this.gwextra=.5*(this.w-6*this.gw),this.h=Math.floor(this.size*h)+48,this.hh=Math.floor(this.h/2),this.gh=Math.floor((this.h-48)/6),this.ghextra=.5*(this.h-6*this.gh),this.cs=document.createElement("canvas"),this.cs.setAttribute("width",String(this.w)),this.cs.setAttribute("height",String(this.h)),this.csx=this.cs.getContext("2d"),this.cf=document.createElement("canvas"),this.cf.setAttribute("width",String(this.w)),this.cf.setAttribute("height",String(this.h)),this.cfx=this.cf.getContext("2d"),g[this.f.r.hchoose([1,1,1],"outline type")](this),this.csd=this.csx.getImageData(0,0,this.w,this.h),this.cgrid=[];for(let t=0;t<this.gw;t++){this.cgrid[t]=[];for(let s=0;s<this.gh;s++)this.cgrid[t][s]={gx:t,gy:s,x:Math.floor(this.gwextra+6*(t+.5)),y:Math.floor(this.ghextra+6*(s+.5)),state:0}}this.goodcells=[this.cgrid[Math.floor(this.gw/2)][Math.floor(this.gh/2)]];let i=0;for(;i<this.goodcells.length;){const t=this.goodcells[i];if(t.gx>0){const s=this.cgrid[t.gx-1][t.gy];0==s.state&&(this.getspa(s.x,s.y)>0?(s.state=1,this.goodcells.push(s)):s.state=-1)}if(t.gx<this.gw-1){const s=this.cgrid[t.gx+1][t.gy];0==s.state&&(this.getspa(s.x,s.y)>0?(s.state=1,this.goodcells.push(s)):s.state=-1)}if(t.gy>0){const s=this.cgrid[t.gx][t.gy-1];0==s.state&&(this.getspa(s.x,s.y)>0?(s.state=1,this.goodcells.push(s)):s.state=-1)}if(t.gy<this.gh-1){const s=this.cgrid[t.gx][t.gy+1];0==s.state&&(this.getspa(s.x,s.y)>0?(s.state=1,this.goodcells.push(s)):s.state=-1)}i++}for(let t=0;t<this.goodcells.length;t++){const s=this.goodcells[t],e=this.cgrid[this.gw-1-s.gx][s.gy];1!=e.state&&(e.state=1,this.goodcells.push(e))}this.passes=this.f.r.hi(1,2,"base component passes"),this.extra=Math.max(1,Math.floor(this.goodcells.length*this.f.r.hd(0,1/this.passes,"extra component amount"))),this.totalcomponents=this.passes*this.goodcells.length+this.extra}getcell(t,s){const e=Math.floor((t-this.gwextra)/6),o=Math.floor((s-this.ghextra)/6);return e<0||e>=this.gw||o<0||o>=this.gh?null:this.cgrid[e][o]}getcellstate(t,s){const e=this.getcell(t,s);return null==e?0:e.state}getspa(t,s){return t=Math.floor(t),s=Math.floor(s),t<0||t>this.w||s<0||s>this.h?-1:this.csd.data[4*(s*this.w+t)+3]}getpcdone(){return this.totaldone/this.totalcomponents}addcomponent(){let t;if(this.nextpass<this.passes)this.nextcell<this.goodcells.length?(t=this.goodcells[this.nextcell],this.nextcell++):(this.nextpass++,t=this.goodcells[0],this.nextcell=1);else{if(!(this.extradone<this.extra))return!0;t=this.goodcells[this.r.si(0,this.goodcells.length-1)],this.extradone++}let s=[t.x,t.y];for(let e=0;e<10;e++){const e=[t.x+this.r.si(-6,6),t.y+this.r.si(-6,6)];if(!(e[0]<24||e[0]>this.w-24||e[1]<24||e[1]>this.h-24)&&!(this.getspa(e[0],e[1])<=0)){s=e;break}}return Math.abs(s[0]-this.hw)<6&&this.r.sb(this.f.r.hd(0,1,"com middleness"))&&(s[0]=Math.floor(this.hw)),M[this.r.schoose(this.f.componentChances)](this,s),this.totaldone++,!1}}const m="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";function w(){for(var t,s,e="",o=0;o<16;o++)e+=m[(t=0,s=m.length,Math.floor(Math.random()*(s-t+1)+t))];return e}function b(){const t=w(),s=w(),e=new p(new n(t),s,100);return function(t){var s=!1;do{s=t.addcomponent()}while(!s);t.cfx.clearRect(t.hw+t.w%2,0,t.w,t.h),t.cfx.scale(-1,1),t.cfx.drawImage(t.cf,0-t.w,0)}(e),e.cf}}])}));