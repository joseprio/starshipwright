!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.starshipwright=r():t.starshipwright=r()}(window,(function(){return function(t){var r={};function s(e){if(r[e])return r[e].exports;var h=r[e]={i:e,l:!1,exports:{}};return t[e].call(h.exports,h,h.exports,s),h.l=!0,h.exports}return s.m=t,s.c=r,s.d=function(t,r,e){s.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:e})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,r){if(1&r&&(t=s(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(s.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var h in t)s.d(e,h,function(r){return t[r]}.bind(null,h));return e},s.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(r,"a",r),r},s.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},s.p="",s(s.s=0)}([function(t,r,s){"use strict";s.r(r),s.d(r,"newship",(function(){return S})),s.d(r,"newfaction",(function(){return P}));class e{constructor(t){this.seedPosition=0,this.arrayPosition=0,this.hrCache={},this.seed=t,this.seed.length<8&&(this.seed="padding_"+this.seed),this.seed.length%2==0&&(this.seed="1"+this.seed),this.stateArray=[2972948403,3086140710,2071788248,3026137486,1411764137,2265725585,2923087685,1593177610],this.state=3234042090;for(var r=this.seed.length-1;r>=0;r--){var s=this.seed.charCodeAt(r);this.state=((this.state<<5)+this.state^s^this.state<<s%13+1^this.state>>s%17+1)>>>0,this.stateArray[r%8]^=((this.state>>9)*(this.state%16384+3427)^s)>>>0}}sr(){var t=this.seed.charCodeAt(this.seedPosition),r=this.stateArray[this.arrayPosition];return this.state=((this.state<<5)+this.state+r^t^this.state<<t%17+1^this.state>>t%13+1)>>>0,this.stateArray[this.arrayPosition]=(r>>3^r<<t%19+1^this.state%134217728*3427)>>>0,this.seedPosition=(this.seedPosition+1)%this.seed.length,this.arrayPosition=(this.arrayPosition+1)%8,this.state}hr_xorshift(t){const r=[1160605769,1424711319,876532818,1419174464];let s=1206170165;if(null==t&&(t="?/?/?/",s=3379896793),this.hrCache.hasOwnProperty(t))return this.hrCache[t];for(var e=t.length-1;e>=0;e--){const h=t.charCodeAt(e);let o=r[0]^h;o=(o^o<<11)>>>0,o=(o^o>>8)>>>0,r[0]=r[1],r[1]=r[2],r[2]=r[3],r[3]=(r[3]^r[3]>>19^o)>>>0,s=3427*(s^h<<24)^r[3]}for(var h=this.seed.length-1;h>=0;h--){const t=this.seed.charCodeAt(h);let e=r[0]^t;e=(e^e<<11)>>>0,e=(e^e>>8)>>>0,r[0]=r[1],r[1]=r[2],r[2]=r[3],r[3]=(r[3]^r[3]>>19^e)>>>0,s=3427*(s^t<<24)^r[3]}return this.hrCache[t]=s>>>0,this.hrCache[t]}sd(t,r){return(4294967296*this.sr()+this.sr())/0x10000000000000000*(r-t)+t}hd(t,r,s){return(4294967296*this.hr_xorshift(s)+this.hr_xorshift(s+"@"))/0x10000000000000000*(r-t)+t}si(t,r){return Math.floor((4294967296*this.sr()+this.sr())/0x10000000000000000*(r+1-t)+t)}hi(t,r,s){return Math.floor((4294967296*this.hr_xorshift(s)+this.hr_xorshift(s+"@"))/0x10000000000000000*(r+1-t)+t)}sb(t){return(4294967296*this.sr()+this.sr())/0x10000000000000000<t}hb(t,r){return(4294967296*this.hr_xorshift(r)+this.hr_xorshift(r+"@"))/0x10000000000000000<t}ss(t){return(4294967296*this.sr()+this.sr())/0x10000000000000000<t?-1:1}hs(t,r){return(4294967296*this.hr_xorshift(r)+this.hr_xorshift(r+"@"))/0x10000000000000000<t?-1:1}sseq(t,r){for(var s=0;(4294967296*this.sr()+this.sr())/0x10000000000000000<t&&s<r;)s++;return s}hseq(t,r,s){for(var e=0;(4294967296*this.hr_xorshift(s+e)+this.hr_xorshift(s+"@"+e))/0x10000000000000000<t&&e<r;)e++;return e}schoose(t){for(var r=0,s=0;s<t.length;s++)r+=t[s];for(var e=this.sd(0,r),h=0;h<t.length;h++)if((e-=t[h])<0)return h;return 0}hchoose(t,r){for(var s=0,e=0;e<t.length;e++)s+=t[e];for(var h=this.hd(0,s,r),o=0;o<t.length;o++)if((h-=t[o])<0)return o;return 0}}function h(t,r,s){return Math.max(r,Math.min(s,t))}function o(t,r){for(var s=Math.floor(t).toString(16);s.length<r;)s="0"+s;return s}function i(t){return"#"+o(Math.floor(255*h(t[0],0,1)),2)+(o(Math.floor(255*h(t[1],0,1)),2)+o(Math.floor(255*h(t[2],0,1)),2))}function a(t,r){return[t[0]*r,t[1]*r,t[2]*r]}function c(t){var r=t[1]*t[2],s=t[2]-r,e=6*((t[0]%1+1)%1),h=Math.floor(e),o=r*(1-Math.abs(e%2-1));switch(h){case 0:return[r+s,o+s,s];case 1:return[o+s,r+s,s];case 2:return[s,r+s,o+s];case 3:return[s,o+s,r+s];case 4:return[o+s,s,r+s];default:return[r+s,s,o+s]}}class n{constructor(t){this.componentChances=[],this.colors=[],this.colorChances=[],this.seed=t,this.r=new e(this.seed),this.cache={},this.setupComponentChances(),this.setupColors()}setupComponentChances(){this.componentChances=[];this.componentChances[0]=.8*this.r.sd(.001,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[1]=.9*this.r.sd(.01,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[2]=1*this.r.sd(.001,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[3]=3*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[4]=.5*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[5]=.05*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[6]=.5*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8))}setupColors(){const t=1+(this.r.hb(.7,"base color +1")?1:0)+this.r.hseq(.3,3,"base color count");for(var r=0;r<t;r++){var s="base color"+r;this.colors.push(c([Math.pow(this.r.hd(0,1,s+"hue"),2),h(this.r.hd(-.2,1,s+"saturation"),0,Math.pow(this.r.hd(0,1,s+"saturation bound"),4)),h(this.r.hd(.7,1.1,s+"value"),0,1)])),this.colorChances.push(Math.pow(2,this.r.hd(0,6,s+"chances")))}}getBaseColor(t){var r=this.colors[t.r.schoose(this.colorChances)];return t.r.sb(Math.pow(this.r.hd(0,.5,"base color shift chance"),2))&&((r=[r[0],r[1],r[2]])[0]=h(r[0]+Math.pow(this.r.hd(0,.6,"base color shift range red"),2)*h(t.r.sd(-1,1.2),0,1)*h(t.r.ss(.7)+t.r.ss(.7),-1,1),0,1),r[1]=h(r[1]+Math.pow(this.r.hd(0,.6,"base color shift range green"),2)*h(t.r.sd(-1,1.2),0,1)*h(t.r.ss(.7)+t.r.ss(.7),-1,1),0,1),r[2]=h(r[2]+Math.pow(this.r.hd(0,.6,"base color shift range blue"),2)*h(t.r.sd(-1,1.2),0,1)*h(t.r.ss(.7)+t.r.ss(.7),-1,1),0,1)),r}}function l(t,r){return 1-r[1]/t.h}function f(t,r,s,e){let h=1;return s&&(h=Math.min(h,1-Math.abs(r[0]-t.hw)/t.hw)),e&&(h=Math.min(h,1-Math.abs(r[1]-t.hh)/t.hh)),h}function d(t,r){return f(t,r,!0,!0)*(1-1/((t.w+t.h)/1e3+1))*Math.pow(t.f.r.hd(0,1,"master bigness"),.5)*(1-t.getpcdone())}function x(t,r){return[Math.min(r[0][0]-24,t.w-24-r[1][0]),Math.min(r[0][1]-24,t.h-24-r[1][1])]}function u(t,r,s,e){const o=t.cfx.createLinearGradient(s[0],s[1],2*r[0]-s[0],2*r[1]-s[1]),i=function(t){return"rgba(0,0,0,"+h(t,0,1)+")"}(e);return o.addColorStop(0,i),o.addColorStop(.5,"rgba(0,0,0,0)"),o.addColorStop(1,i),o}const M=[];M[0]=function(t,r){let s=8;var e=Math.pow(d(t,r),.3);if(t.r.sb(t.f.r.hd(0,.9,"com0 bigchance")*e))for(;t.r.sb(t.f.r.hd(0,.5,"com0 bigincchance")*e);){var o=x(t,[[r[0]-s,r[1]-s],[r[0]+s,r[1]+s]]);if(!(Math.min(o[0],o[1])>.5*s))break;s*=1.5}var c=2*s,n=[Math.ceil(t.r.sd(1,Math.max(2,.5*s))),Math.ceil(t.r.sd(1,Math.max(2,.5*s)))],l=Math.min(n[0],n[1])*t.r.sd(.1,1.2),f=[n[0]+2*l,n[1]+2*l],M=[Math.ceil(c/f[0]),Math.ceil(c/f[1])],g=[Math.round(M[0]*f[0]/2),Math.round(M[1]*f[1]/2)],p=t.getpcdone(),m=t.f.getBaseColor(t),v=i(a(m,t.r.sd(.4,1))),w=i(a(m,t.r.sd(.4,1)));t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.25)+")",t.cfx.fillRect(r[0]-g[0]-1,r[1]-g[1]-1,f[0]*M[0]+2,f[1]*M[1]+2),t.cfx.fillStyle=w,t.cfx.fillRect(r[0]-g[0],r[1]-g[1],f[0]*M[0],f[1]*M[1]),t.cfx.fillStyle=v;for(var b=0;b<M[0];b++)for(var C=r[0]+l+b*f[0]-g[0],y=0;y<M[1];y++){var S=r[1]+l+y*f[1]-g[1];t.cfx.fillRect(C,S,n[0],n[1])}t.r.sb(h(s/8*(.6*p+.3),0,.98))&&(t.cfx.fillStyle=u(t,r,[r[0]+g[0],r[1]],t.r.sd(0,.9)),t.cfx.fillRect(r[0]-g[0],r[1]-g[1],f[0]*M[0],f[1]*M[1]))},M[1]=function(t,r){var s=8,e=Math.pow(d(t,r),.2);if(t.r.sb(t.f.r.hd(.3,1,"com1 bigchance")*e))for(;t.r.sb(t.f.r.hd(0,.6,"com1 bigincchance")*e);){var o=x(t,[[r[0]-s,r[1]-s],[r[0]+s,r[1]+s]]);if(!(Math.min(o[0],o[1])>.5*s))break;s*=1.5}var c=Math.ceil(t.r.sd(.8,2)*s),n=Math.ceil(t.r.sd(.8,2)*s),l=t.r.si(3,Math.max(4,c)),f=Math.max(1,Math.round(c/l));c=f*l;var M=i(a(t.f.getBaseColor(t),t.r.sd(.5,1))),g=t.r.sd(.3,.9);if(t.r.sb(h(t.f.r.hd(-.2,1.2,"com1 hchance"),0,1))){var p=[r[0]-Math.floor(c/2),r[1]-Math.floor(n/2)];t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.25)+")",t.cfx.fillRect(p[0]-1,p[1]-1,c+2,n+2),t.cfx.fillStyle=M,t.cfx.fillRect(p[0],p[1],c,n);for(var m=0;m<f;m++)t.cfx.fillStyle=u(t,[p[0]+(m+.5)*l,r[1]],[p[0]+m*l,r[1]],g),t.cfx.fillRect(p[0]+m*l,p[1],l,n)}else{p=[r[0]-Math.floor(n/2),r[1]-Math.floor(c/2)];t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.25)+")",t.cfx.fillRect(p[0]-1,p[1]-1,n+2,c+2),t.cfx.fillStyle=M,t.cfx.fillRect(p[0],p[1],n,c);for(m=0;m<f;m++)t.cfx.fillStyle=u(t,[r[0],p[1]+(m+.5)*l],[r[0],p[1]+m*l],g),t.cfx.fillRect(p[0],p[1]+m*l,c,l)}},M[2]=function(t,r){let s=8;var e=Math.pow(d(t,r),.05);if(t.r.sb(t.f.r.hd(0,1,"com2 bigchance")*e))for(;t.r.sb(t.f.r.hd(0,.9,"com2 bigincchance")*e);){var o=x(t,[[r[0]-s,r[1]-s],[r[0]+s,r[1]+s]]);if(!(Math.min(o[0],o[1])>.5*s))break;s*=1.5}var c=Math.ceil(t.r.sd(.6,1.4)*s),n=Math.ceil(t.r.sd(1,2)*s),l=[Math.ceil(h(c*t.r.sd(.7,1)/2,1,c)),Math.ceil(h(c*t.r.sd(.8,1)/2,1,c))],f=[Math.floor(h(c*t.r.sd(.05,.25),1,n)),Math.floor(h(c*t.r.sd(.1,.3),1,n))],u=f[0]+f[1],M=t.r.sb(Math.pow(t.f.r.hd(0,1,"com2 oddchance"),.5)),g=h(Math.floor(n/u),1,n),p=g*u+(M?f[0]:0),m=t.f.getBaseColor(t),v=[a(m,t.r.sd(.6,1)),a(m,t.r.sd(.6,1))],w=1-t.r.sd(.5,.95),b=[a(v[0],w),a(v[1],w)];if(t.r.sb(Math.pow(t.f.r.hd(0,1,"com2 verticalchance"),.1))){(S=[t.cfx.createLinearGradient(r[0]-l[0],r[1],r[0]+l[0],r[1]),t.cfx.createLinearGradient(r[0]-l[1],r[1],r[0]+l[1],r[1])])[0].addColorStop(0,i(b[0])),S[0].addColorStop(.5,i(v[0])),S[0].addColorStop(1,i(b[0])),S[1].addColorStop(0,i(b[1])),S[1].addColorStop(.5,i(v[1])),S[1].addColorStop(1,i(b[1]));for(var C=Math.floor(r[1]-p/2),y=0;y<g;y++)t.cfx.fillStyle=S[0],t.cfx.fillRect(r[0]-l[0],C+y*u,2*l[0],f[0]),t.cfx.fillStyle=S[1],t.cfx.fillRect(r[0]-l[1],C+y*u+f[0],2*l[1],f[1]);M&&(t.cfx.fillStyle=S[0],t.cfx.fillRect(r[0]-l[0],C+g*u,2*l[0],f[0]))}else{var S;(S=[t.cfx.createLinearGradient(r[0],r[1]-l[0],r[0],r[1]+l[0]),t.cfx.createLinearGradient(r[0],r[1]-l[1],r[0],r[1]+l[1])])[0].addColorStop(0,i(b[0])),S[0].addColorStop(.5,i(v[0])),S[0].addColorStop(1,i(b[0])),S[1].addColorStop(0,i(b[1])),S[1].addColorStop(.5,i(v[1])),S[1].addColorStop(1,i(b[1]));var P=Math.floor(r[0]-p/2);for(y=0;y<g;y++)t.cfx.fillStyle=S[0],t.cfx.fillRect(P+y*u,r[1]-l[0],f[0],2*l[0]),t.cfx.fillStyle=S[1],t.cfx.fillRect(P+y*u+f[0],r[1]-l[1],f[1],2*l[1]);M&&(t.cfx.fillStyle=S[0],t.cfx.fillRect(P+g*u,r[1]-l[0],f[0],2*l[0]))}},M[3]=function(t,r){if(t.r.sb(l(t,r)-.3)||t.getcellstate(r[0],r[1]+6*1.2)>0||t.getcellstate(r[0],r[1]+10.8)>0)for(var s=0;s<100;s++){var e=t.r.schoose(t.f.componentChances);if(3!=e)return void M[e](t,r)}let h=8;var o=Math.pow(d(t,r),.1);if(t.r.sb(t.f.r.hd(.6,1,"com3 bigchance")*o))for(;t.r.sb(t.f.r.hd(.3,.8,"com3 bigincchance")*o);){const s=x(t,[[r[0]-h,r[1]-h],[r[0]+h,r[1]+h]]);if(!(Math.min(s[0],s[1])>.5*h))break;h*=1.5}var c=t.r.sd(1,2)*h,n=Math.ceil(t.r.sd(.3,1)*h),f=c*t.r.sd(.25,.6),u=(c+f)/2/2,g=[Math.max(1,Math.ceil(n*t.r.sd(.08,.25))),Math.max(1,Math.ceil(n*t.r.sd(.03,.15)))],p=g[0]+g[1],m=Math.ceil(n/p);n=m*p+g[0],t.f.setupColors();var v=t.f.colors[t.f.r.hchoose(t.f.colorChances,"com3 basecolor")],w=t.f.r.hd(.5,.8,"com3 lightness0 mid"),b=w-t.f.r.hd(.2,.4,"com3 lightness0 edge"),C=t.f.r.hd(0,.2,"com3 lightness1 edge"),y=[t.cfx.createLinearGradient(r[0]-u,r[1],r[0]+u,r[1]),t.cfx.createLinearGradient(r[0]-u,r[1],r[0]+u,r[1])];y[0].addColorStop(0,i(a(v,b))),y[0].addColorStop(.5,i(a(v,w))),y[0].addColorStop(1,i(a(v,b))),y[1].addColorStop(0,i(a(v,C))),y[1].addColorStop(.5,i(v)),y[1].addColorStop(1,i(a(v,C)));const S=Math.ceil(r[1]-n/2);t.cfx.fillStyle=y[0],t.cfx.beginPath(),t.cfx.moveTo(r[0]-f/2,S),t.cfx.lineTo(r[0]+f/2,S),t.cfx.lineTo(r[0]+c/2,S+n),t.cfx.lineTo(r[0]-c/2,S+n),t.cfx.fill(),t.cfx.fillStyle=y[1];var P=[S+g[0],S+p];for(let s=0;s<m;s++){const e=[s*p+g[0],(s+1)*p],h=[P[0]+s*p,P[1]+s*p],o=[(f+(c-f)*(e[0]/n))/2,(f+(c-f)*(e[1]/n))/2];t.cfx.beginPath(),t.cfx.moveTo(r[0]-o[0],h[0]),t.cfx.lineTo(r[0]+o[0],h[0]),t.cfx.lineTo(r[0]+o[1],h[1]),t.cfx.lineTo(r[0]-o[1],h[1]),t.cfx.fill()}},M[4]=function(t,r){var s=f(t,r,!0,!1),e=t.r.sd(.7,1),h=t.r.sd(0,.2),o=t.f.getBaseColor(t),c=i(a(o,e)),n=i(a(o,h));null==t.f.cache["com4 directionc"]&&(t.f.cache["com4 directionc"]=[1*Math.pow(t.f.r.hd(0,1,"com4 directionc0"),4),.1*Math.pow(t.f.r.hd(0,1,"com4 directionc1"),4),.2*Math.pow(t.f.r.hd(0,1,"com4 directionc2"),4)]);var l=Math.max(3,Math.ceil(t.size*Math.pow(t.r.sd(.4,1),2)*t.f.r.hd(.02,.1,"com4 maxwidth"))),d=Math.floor(l/2),x=l%2,u=t.r.schoose([t.f.cache["com4 directionc"][0]*(2-s),t.f.cache["com4 directionc"][1],t.f.cache["com4 directionc"][2]*(1+s)]),g=null;if(0==u){var p=r[1]-24,m=Math.min(Math.max(8,p-t.r.si(0,16)),Math.floor(.7*t.size*Math.pow(t.r.sd(0,1),t.f.r.hd(2,6,"com4 hpower0")))),v=[[r[0]-d,r[1]-m],[r[0]+d+x,r[1]]];(w=t.cfx.createLinearGradient(v[0][0],v[0][1],v[1][0],v[0][1])).addColorStop(0,n),w.addColorStop(.5,c),w.addColorStop(1,n),t.cfx.fillStyle=w,t.cfx.fillRect(v[0][0],v[0][1],l,m),g=[r[0],r[1]-m]}else if(1==u){p=t.h-(24+r[1]),m=Math.min(Math.max(8,p-t.r.si(0,16)),Math.floor(.6*t.size*Math.pow(t.r.sd(0,1),t.f.r.hd(2,7,"com4 hpower1")))),v=[[r[0]-d,r[1]],[r[0]+d+x,r[1]+m]];(w=t.cfx.createLinearGradient(v[0][0],v[0][1],v[1][0],v[0][1])).addColorStop(0,n),w.addColorStop(.5,c),w.addColorStop(1,n),t.cfx.fillStyle=w,t.cfx.fillRect(v[0][0],v[0][1],l,m),g=[r[0],r[1]+m]}else if(2==u){var w;(w=t.cfx.createLinearGradient(r[0],r[1]-d,r[0],r[1]+d+x)).addColorStop(0,n),w.addColorStop(.5,c),w.addColorStop(1,n),t.cfx.fillStyle=w,t.cfx.fillRect(r[0],r[1]-d,Math.ceil(t.hw-r[0])+1,l),g=[Math.floor(t.hw),r[1]+m]}if(null==t.f.cache["com4 covercomc"]&&(t.f.cache["com4 covercomc"]=[.6*Math.pow(t.f.r.hd(0,1,"com4 covercomc0"),2),.2*Math.pow(t.f.r.hd(0,1,"com4 covercomc1"),2),1*Math.pow(t.f.r.hd(0,1,"com4 covercomc2"),2)]),M[t.r.schoose(t.f.cache["com4 covercomc"])](t,r),t.getcellstate(g[0],g[1])>0){var b=[g[0]+Math.round(6*t.r.sd(-1,1)),g[1]+Math.round(6*t.r.sd(-1,1))];t.getcellstate(b[0],b[1])>0?M[t.r.schoose(t.f.cache["com4 covercomc"])](t,b):M[t.r.schoose(t.f.cache["com4 covercomc"])](t,g)}},M[5]=function(t,r){let s=8;var e=Math.pow(d(t,r),.1);if(t.r.sb(t.f.r.hd(0,.9,"com5 bigchance")*e))for(;t.r.sb(t.f.r.hd(0,.8,"com5 bigincchance")*e);){var h=x(t,[[r[0]-s,r[1]-s],[r[0]+s,r[1]+s]]);if(!(Math.min(h[0],h[1])>.5*s))break;s*=1.5}var o=t.r.sd(.75,1),c=t.r.sd(0,.25),n=t.f.getBaseColor(t),l=i(a(n,o)),f=i(a(n,c)),u=1+t.r.sseq(t.f.r.hd(0,1,"com5 multxc"),Math.floor(1.2*Math.pow(s/8,.6))),M=1+t.r.sseq(t.f.r.hd(0,1,"com5 multyc"),Math.floor(1.2*Math.pow(s/8,.6))),g=t.r.sd(.5,1)*s/Math.max(u,M),p=g+.5,m=g+1,v=.2*g,w=g*u,b=g*M,C=[r[0]-w,r[1]-b];t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.2)+")";for(var y=0;y<u;y++)for(var S=C[0]+(2*y+1)*g,P=0;P<M;P++){var R=C[1]+(2*P+1)*g;t.cfx.beginPath(),t.cfx.arc(S,R,m,0,2*Math.PI),t.cfx.fill()}for(y=0;y<u;y++)for(S=C[0]+(2*y+1)*g,P=0;P<M;P++){R=C[1]+(2*P+1)*g;var T=t.cfx.createRadialGradient(S,R,v,S,R,p);T.addColorStop(0,l),T.addColorStop(1,f),t.cfx.fillStyle=T,t.cfx.beginPath(),t.cfx.arc(S,R,p,0,2*Math.PI),t.cfx.fill()}},M[6]=function(t,r){if(t.nextpass<=0||t.r.sb(l(t,r)))return void M[t.r.schoose(function(t,r,s){const e=new Array(s-r);for(let h=s;h>=r;h--)e[h-r]=t[h];return e}(t.f.componentChances,0,5))](t,r);let s=8;var e=Math.pow(d(t,r),.05);if(t.r.sb(t.f.r.hd(0,.9,"com6 bigchance")*e))for(;t.r.sb(t.f.r.hd(0,.8,"com6 bigincchance")*e);){var h=x(t,[[r[0]-s,r[1]-s],[r[0]+s,r[1]+s]]);if(!(Math.min(h[0],h[1])>.5*s))break;s*=1.5}var o=Math.ceil(2*s*t.r.sd(.6,1)),c=Math.floor(o/2),n=o%2,f=o*Math.pow(t.r.sd(Math.pow(t.f.r.hd(0,.8,"com6 h1min"),.5),.9),t.f.r.hd(.5,1.5,"com6 h1power")),u=Math.floor(f/2),g=o%2,p=Math.max(0-(o-f)/2,o*(t.r.sd(0,.45)+t.r.sd(0,.45))*(null==t.f.cache["com6 backness"]?t.f.cache["com6 backness"]=t.f.r.hb(.8,"com6 backnesstype")?t.f.r.hd(.2,.9,"com6 backness#pos"):t.f.r.hd(-.2,-.05,"com6 backness#neg"):t.f.cache["com6 backness"])),m=Math.ceil(s*t.r.sd(.7,1)*Math.pow(t.f.r.hd(.1,3.5,"com6 width"),.5)),v=Math.floor(m/2),w=m%2,b=[[r[0]-v,r[1]+p-u],[r[0]+v+w,r[1]-c],[r[0]+v+w,r[1]+c+n],[r[0]-v,r[1]+p+u+g]],C=t.f.getBaseColor(t);t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.2)+")",t.cfx.beginPath(),t.cfx.moveTo(b[0][0]-1,b[0][1]),t.cfx.lineTo(b[1][0]-1,b[1][1]),t.cfx.lineTo(b[2][0]-1,b[2][1]),t.cfx.lineTo(b[3][0]-1,b[3][1]),t.cfx.fill(),t.cfx.fillStyle=i(a(C,t.r.sd(.7,1))),t.cfx.beginPath(),t.cfx.moveTo(b[0][0],b[0][1]),t.cfx.lineTo(b[1][0],b[1][1]),t.cfx.lineTo(b[2][0],b[2][1]),t.cfx.lineTo(b[3][0],b[3][1]),t.cfx.fill()};const g=[];g[0]=function(t){for(var r=.05*((t.w-48)*(t.h-48)),s=Math.ceil((t.w-48)*t.f.r.hd(.1,1,"outline0 iw")*.2),e=[[[t.hw-s,24],[t.hw+s,t.h-24]]],o=2+Math.floor(t.r.sd(.5,1)*t.f.r.hd(2,8,"outline0 bc")*Math.sqrt(t.size)),i=1;i<o;i++){var a=e[t.r.si(0,e.length-1)],c=[a[0][0]+t.r.sd(0,1)*(a[1][0]-a[0][0]),a[0][1]+t.r.sd(0,1)*(a[1][1]-a[0][1])];c[1]<.5*(a[0][1]+a[1][1])&&t.r.sb(t.f.r.hd(.5,1.5,"outline0 frontbias"))&&(c[1]=a[1][1]-(c[1]-a[0][1]));var n=[h(t.r.sd(0,1)*t.w,24,t.w-24),h(t.r.sd(0,1)*t.h,24,t.h-24)],l=r/Math.abs((n[0]-c[0])*(n[1]-c[1]));if(l<1&&(n[0]=c[0]+(n[0]-c[0])*l,n[1]=c[1]+(n[1]-c[1])*l),c[0]>n[0]){var f=c[0];c[0]=n[0],n[0]=f}if(c[1]>n[1]){f=c[1];c[1]=n[1],n[1]=f}e.push([[Math.floor(c[0]),Math.floor(c[1])],[Math.ceil(n[0]),Math.ceil(n[1])]])}t.csx.fillStyle="#FFFFFF";for(i=0;i<e.length;i++){var d=e[i];t.csx.fillRect(d[0][0],d[0][1],d[1][0]-d[0][0],d[1][1]-d[0][1]),t.csx.fillRect(t.w-d[1][0],d[0][1],d[1][0]-d[0][0],d[1][1]-d[0][1])}},g[1]=function(t){for(var r=.05*((t.w-48)*(t.h-48)),s=Math.max(2,Math.sqrt(r/Math.PI)),e=Math.ceil((t.w-48)*t.f.r.hd(.1,1,"outline1 iw")*.2),h=[],o=Math.floor((t.h-48)/(2*e)),i=0;i<o;i++){let r=[t.hw,t.h-(24+e*(2*i+1))];h.push({v:r,r:e})}var a=o+Math.floor(t.r.sd(.5,1)*t.f.r.hd(10,50,"outline1 cc")*Math.sqrt(t.size));for(i=o;i<a;i++){var c=h[Math.max(t.r.si(0,h.length-1),t.r.si(0,h.length-1))],n=t.r.sd(1,s),l=t.r.sd(Math.max(0,c.r-n),c.r);if((f=t.r.sd(0,2*Math.PI))>Math.PI&&t.r.sb(t.f.r.hd(.5,1.5,"outline1 frontbias")))var f=t.r.sd(0,Math.PI);let r=[c.v[0]+Math.cos(f)*l,c.v[1]+Math.sin(f)*l];n=Math.min(n,r[0]-24),n=Math.min(n,t.w-24-r[0]),n=Math.min(n,r[1]-24),n=Math.min(n,t.h-24-r[1]),h.push({v:r,r:n})}t.csx.fillStyle="#FFFFFF";for(let r=0;r<h.length;r++){const s=h[r];t.csx.beginPath(),t.csx.arc(s.v[0],s.v[1],s.r,0,2*Math.PI),t.csx.fill(),t.csx.beginPath(),t.csx.arc(t.w-s.v[0],s.v[1],s.r,0,2*Math.PI),t.csx.fill()}},g[2]=function(t){var r=[t.w-48,t.h-48],s=[[t.hw,t.r.sd(0,.05)*r[1]+24],[t.hw,t.r.sd(.95,1)*r[1]+24]],e=6/t.size+t.f.r.hd(.03,.1,"outline2 basefatness"),h=1/e,o=Math.max(3,Math.ceil(h*t.r.sd(.05,.1)*Math.sqrt(t.size)));t.csx.lineCap=["round","square"][t.f.r.hi(0,1,"outline2 linecap")],t.csx.strokeStyle="#FFFFFF";for(var i=1;i<o;i++){var a=s[i];null==a&&(a=[t.r.sd(0,1)*r[0]+24,Math.pow(t.r.sd(0,1),t.f.r.hd(.1,1,"outline2 frontbias"))*r[1]+24],s.push(a));for(var c=1+t.r.sseq(t.f.r.hd(0,1,"outline2 conadjust"),3),n=0;n<c;n++){var l=s[t.r.si(0,s.length-2)];t.csx.lineWidth=t.r.sd(.7,1)*e*t.size,t.csx.beginPath(),t.csx.moveTo(l[0],l[1]),t.csx.lineTo(a[0],a[1]),t.csx.stroke(),t.csx.beginPath(),t.csx.moveTo(t.w-l[0],l[1]),t.csx.lineTo(t.w-a[0],a[1]),t.csx.stroke()}}};class p{constructor(t,r){this.extradone=0,this.nextpass=0,this.nextcell=0,this.totaldone=0,this.f=t,this.baseSeed=r,this.seed=this.f.seed+this.baseSeed,this.r=new e(this.seed),this.size=Math.pow(this.r.sd(this.f.r.hd(2.5,3.5,"size min"),this.f.r.hd(5,7,"size max")),3);const s=this.r.sd(this.f.r.hd(.5,1,"wratio min"),this.f.r.hd(1,1.3,"wratio max")),h=this.r.sd(this.f.r.hd(.7,1,"hratio min"),this.f.r.hd(1.1,1.7,"hratio max"));this.w=Math.floor(this.size*s)+48,this.hw=Math.floor(this.w/2),this.gw=Math.floor((this.w-48)/6),this.gwextra=.5*(this.w-6*this.gw),this.h=Math.floor(this.size*h)+48,this.hh=Math.floor(this.h/2),this.gh=Math.floor((this.h-48)/6),this.ghextra=.5*(this.h-6*this.gh),this.cs=document.createElement("canvas"),this.cs.setAttribute("width",String(this.w)),this.cs.setAttribute("height",String(this.h)),this.csx=this.cs.getContext("2d"),this.cf=document.createElement("canvas"),this.cf.setAttribute("width",String(this.w)),this.cf.setAttribute("height",String(this.h)),this.cfx=this.cf.getContext("2d"),g[this.f.r.hchoose([1,1,1],"outline type")](this),this.csd=this.csx.getImageData(0,0,this.w,this.h),this.cgrid=[];for(var o=0;o<this.gw;o++){this.cgrid[o]=[];for(var i=0;i<this.gh;i++)this.cgrid[o][i]={gx:o,gy:i,x:Math.floor(this.gwextra+6*(o+.5)),y:Math.floor(this.ghextra+6*(i+.5)),state:0}}this.goodcells=[this.cgrid[Math.floor(this.gw/2)][Math.floor(this.gh/2)]];for(var a=0;a<this.goodcells.length;){var c;if((l=this.goodcells[a]).gx>0)0==(c=this.cgrid[l.gx-1][l.gy]).state&&(this.getspa(c.x,c.y)>0?(c.state=1,this.goodcells.push(c)):c.state=-1);if(l.gx<this.gw-1)0==(c=this.cgrid[l.gx+1][l.gy]).state&&(this.getspa(c.x,c.y)>0?(c.state=1,this.goodcells.push(c)):c.state=-1);if(l.gy>0)0==(c=this.cgrid[l.gx][l.gy-1]).state&&(this.getspa(c.x,c.y)>0?(c.state=1,this.goodcells.push(c)):c.state=-1);if(l.gy<this.gh-1)0==(c=this.cgrid[l.gx][l.gy+1]).state&&(this.getspa(c.x,c.y)>0?(c.state=1,this.goodcells.push(c)):c.state=-1);a++}for(var n=0;n<this.goodcells.length;n++){var l=this.goodcells[n],f=this.cgrid[this.gw-1-l.gx][l.gy];1!=f.state&&(f.state=1,this.goodcells.push(f))}this.passes=this.f.r.hi(1,2,"base component passes"),this.extra=Math.max(1,Math.floor(this.goodcells.length*this.f.r.hd(0,1/this.passes,"extra component amount"))),this.totalcomponents=this.passes*this.goodcells.length+this.extra}getcell(t,r){var s=Math.floor((t-this.gwextra)/6),e=Math.floor((r-this.ghextra)/6);return s<0||s>=this.gw||e<0||e>=this.gh?null:this.cgrid[s][e]}getcellstate(t,r){var s=this.getcell(t,r);return null==s?0:s.state}getspa(t,r){return t=Math.floor(t),r=Math.floor(r),t<0||t>this.w||r<0||r>this.h?-1:this.csd.data[4*(r*this.w+t)+3]}getpcdone(){return this.totaldone/this.totalcomponents}addcomponent(){var t;if(this.nextpass<this.passes)this.nextcell<this.goodcells.length?(t=this.goodcells[this.nextcell],this.nextcell++):(this.nextpass++,t=this.goodcells[0],this.nextcell=1);else{if(!(this.extradone<this.extra))return!0;t=this.goodcells[this.r.si(0,this.goodcells.length-1)],this.extradone++}for(var r=[t.x,t.y],s=0;s<10;s++){var e=[t.x+this.r.si(-6,6),t.y+this.r.si(-6,6)];if(!(e[0]<24||e[0]>this.w-24||e[1]<24||e[1]>this.h-24)&&!(this.getspa(e[0],e[1])<=0)){r=e;break}}return Math.abs(r[0]-this.hw)<6&&this.r.sb(this.f.r.hd(0,1,"com middleness"))&&(r[0]=Math.floor(this.hw)),M[this.r.schoose(this.f.componentChances)](this,r),this.totaldone++,!1}}function m(t){for(var r=1206170165,s=t.length-1;s>=0;s--){var e=t.charCodeAt(s);r=(r<<5)+r^e^r<<e%13+1^r>>e%17+1}return r>>>0}function v(t,r,s){return null==s?Math.floor(t+Math.random()*(r-t+1)):Math.floor(t+function(t){return(4294967296*m("."+t)+m(t))/0x10000000000000000}(s)*(r-t+1))}var w="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";function b(t,r){for(var s="",e=0;e<t;e++)s+=w[v(0,w.length-1,r+"_"+e)];return s}var C=null;function y(t,r){return C=new p(new n(t),r),function(){if(null!=C){var t=!1;do{t=C.addcomponent()}while(!t);C.cfx.clearRect(C.hw+C.w%2,0,C.w,C.h),C.cfx.scale(-1,1),C.cfx.drawImage(C.cf,0-C.w,0)}}(),C}function S(t){return y(t,b(16,"_"+Math.random()))}function P(){return S(b(16,"_"+Math.random()))}}])}));