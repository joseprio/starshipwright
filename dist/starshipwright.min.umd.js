!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.starshipwright=t():e.starshipwright=t()}(window,(function(){return function(e){var t={};function c(o){if(t[o])return t[o].exports;var h=t[o]={i:o,l:!1,exports:{}};return e[o].call(h.exports,h,h.exports,c),h.l=!0,h.exports}return c.m=e,c.c=t,c.d=function(e,t,o){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(c.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var h in e)c.d(o,h,function(t){return e[t]}.bind(null,h));return o},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="",c(c.s=0)}([function(e,t,c){"use strict";c.r(t),c.d(t,"newship",(function(){return S})),c.d(t,"newfaction",(function(){return C}));class o{constructor(e){this.seedPosition=0,this.arrayPosition=0,this.hrCache={},this.seed=e,this.seed.length<8&&(this.seed="padding_"+this.seed),this.seed.length%2==0&&(this.seed="1"+this.seed),this.stateArray=[2972948403,3086140710,2071788248,3026137486,1411764137,2265725585,2923087685,1593177610],this.state=3234042090;for(var t=this.seed.length-1;t>=0;t--){var c=this.seed.charCodeAt(t);this.state=((this.state<<5)+this.state^c^this.state<<c%13+1^this.state>>c%17+1)>>>0,this.stateArray[t%8]^=((this.state>>9)*(this.state%16384+3427)^c)>>>0}}sr(){var e=this.seed.charCodeAt(this.seedPosition),t=this.stateArray[this.arrayPosition];return this.state=((this.state<<5)+this.state+t^e^this.state<<e%17+1^this.state>>e%13+1)>>>0,this.stateArray[this.arrayPosition]=(t>>3^t<<e%19+1^this.state%134217728*3427)>>>0,this.seedPosition=(this.seedPosition+1)%this.seed.length,this.arrayPosition=(this.arrayPosition+1)%8,this.state}hr_xorshift(e){const t=[1160605769,1424711319,876532818,1419174464];let c=1206170165;if(null==e&&(e="?/?/?/",c=3379896793),this.hrCache.hasOwnProperty(e))return this.hrCache[e];for(var o=e.length-1;o>=0;o--){const h=e.charCodeAt(o);let r=t[0]^h;r=(r^r<<11)>>>0,r=(r^r>>8)>>>0,t[0]=t[1],t[1]=t[2],t[2]=t[3],t[3]=(t[3]^t[3]>>19^r)>>>0,c=3427*(c^h<<24)^t[3]}for(var h=this.seed.length-1;h>=0;h--){const e=this.seed.charCodeAt(h);let o=t[0]^e;o=(o^o<<11)>>>0,o=(o^o>>8)>>>0,t[0]=t[1],t[1]=t[2],t[2]=t[3],t[3]=(t[3]^t[3]>>19^o)>>>0,c=3427*(c^e<<24)^t[3]}return this.hrCache[e]=c>>>0,this.hrCache[e]}sd(e,t){return(4294967296*this.sr()+this.sr())/0x10000000000000000*(t-e)+e}hd(e,t,c){return(4294967296*this.hr_xorshift(c)+this.hr_xorshift(c+"@"))/0x10000000000000000*(t-e)+e}si(e,t){return Math.floor((4294967296*this.sr()+this.sr())/0x10000000000000000*(t+1-e)+e)}hi(e,t,c){return Math.floor((4294967296*this.hr_xorshift(c)+this.hr_xorshift(c+"@"))/0x10000000000000000*(t+1-e)+e)}sb(e){return(4294967296*this.sr()+this.sr())/0x10000000000000000<e}hb(e,t){return(4294967296*this.hr_xorshift(t)+this.hr_xorshift(t+"@"))/0x10000000000000000<e}ss(e){return(4294967296*this.sr()+this.sr())/0x10000000000000000<e?-1:1}hs(e,t){return(4294967296*this.hr_xorshift(t)+this.hr_xorshift(t+"@"))/0x10000000000000000<e?-1:1}sseq(e,t){for(var c=0;(4294967296*this.sr()+this.sr())/0x10000000000000000<e&&c<t;)c++;return c}hseq(e,t,c){for(var o=0;(4294967296*this.hr_xorshift(c+o)+this.hr_xorshift(c+"@"+o))/0x10000000000000000<e&&o<t;)o++;return o}schoose(e){for(var t=0,c=0;c<e.length;c++)t+=e[c];for(var o=this.sd(0,t),h=0;h<e.length;h++)if((o-=e[h])<0)return h;return 0}hchoose(e,t){for(var c=0,o=0;o<e.length;o++)c+=e[o];for(var h=this.hd(0,c,t),r=0;r<e.length;r++)if((h-=e[r])<0)return r;return 0}}function h(e,t,c){return Math.max(t,Math.min(c,e))}function r(e,t){for(var c=Math.floor(e).toString(16);c.length<t;)c="0"+c;return c}function a(e){return"#"+r(Math.floor(255*h(e[0],0,1)),2)+(r(Math.floor(255*h(e[1],0,1)),2)+r(Math.floor(255*h(e[2],0,1)),2))}function i(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function s(e){var t=e[1]*e[2],c=e[2]-t,o=6*((e[0]%1+1)%1),h=Math.floor(o),r=t*(1-Math.abs(o%2-1));switch(h){case 0:return[t+c,r+c,c];case 1:return[r+c,t+c,c];case 2:return[c,t+c,r+c];case 3:return[c,r+c,t+c];case 4:return[r+c,c,t+c];default:return[t+c,c,r+c]}}class n{constructor(e){this.seed=e,this.randomizer=new o(this.seed),this.cache={},this.setupComponentChances()}setupComponentChances(){this.componentChances=[];this.componentChances[0]=.8*this.randomizer.sd(.001,1)*Math.pow(2,this.randomizer.sd(0,8)),this.componentChances[1]=.9*this.randomizer.sd(.01,1)*Math.pow(2,this.randomizer.sd(0,8)),this.componentChances[2]=1*this.randomizer.sd(.001,1)*Math.pow(2,this.randomizer.sd(0,8)),this.componentChances[3]=3*this.randomizer.sd(0,1)*Math.pow(2,this.randomizer.sd(0,8)),this.componentChances[4]=.5*this.randomizer.sd(0,1)*Math.pow(2,this.randomizer.sd(0,8)),this.componentChances[5]=.05*this.randomizer.sd(0,1)*Math.pow(2,this.randomizer.sd(0,8)),this.componentChances[6]=.5*this.randomizer.sd(0,1)*Math.pow(2,this.randomizer.sd(0,8))}setupColors(){if(null==this.cache["base colors"]){var e=6;this.cache["base color count"]=1+(this.randomizer.hb(.7,"base color +1")?1:0)+this.randomizer.hseq(.3,3,"base color count"),this.cache["base colors"]=new Array(this.cache["base color count"]),this.cache["base color chances"]=new Array(this.cache["base color count"]);for(var t=0;t<this.cache["base color count"];t++){var c="base color"+t;this.cache["base colors"][t]=s([Math.pow(this.randomizer.hd(0,1,c+"hue"),2),h(this.randomizer.hd(-.2,1,c+"saturation"),0,Math.pow(this.randomizer.hd(0,1,c+"saturation bound"),4)),h(this.randomizer.hd(.7,1.1,c+"value"),0,1)]),this.cache["base color chances"][t]=Math.pow(2,this.randomizer.hd(0,e,c+"chances"))}}if(null==this.cache["window colors"]){e=5;this.cache["window color count"]=1+(this.randomizer.hb(.3,"window color +1")?1:0),this.cache["window colors"]=new Array(this.cache["window color count"]),this.cache["window color chances"]=new Array(this.cache["window color count"]);for(t=0;t<this.cache["window color count"];t++){c="window color"+t;this.cache["window colors"][t]=s([this.randomizer.hb(.6,"window color blues only")?this.randomizer.hd(1/3,3/4,"window color blue hue"):this.randomizer.hd(0,1,"window color hue"),Math.pow(h(this.randomizer.hd(-.2,1.2,"window color hue"),0,1),.5),Math.pow(h(this.randomizer.hd(.4,1.3,"window color value"),0,1),.5)]),this.cache["window color chances"][t]=Math.pow(2,this.randomizer.hd(0,e,c+"chances"))}}}getBaseColor(e){null==this.cache["base colors"]&&this.setupColors();var t=this.cache["base colors"][e.r.schoose(this.cache["base color chances"])];return e.r.sb(null==this.cache["base color shift chance"]?this.cache["base color shift chance"]=Math.pow(this.randomizer.hd(0,.5,"base color shift chance"),2):this.cache["base color shift chance"])&&((t=[t[0],t[1],t[2]])[0]=h(t[0]+(null==this.cache["base color shift range red"]?this.cache["base color shift range red"]=Math.pow(this.randomizer.hd(0,.6,"base color shift range red"),2):this.cache["base color shift range red"])*h(e.r.sd(-1,1.2),0,1)*h(e.r.ss(.7)+e.r.ss(.7),-1,1),0,1),t[1]=h(t[1]+(null==this.cache["base color shift range green"]?this.cache["base color shift range green"]=Math.pow(this.randomizer.hd(0,.6,"base color shift range green"),2):this.cache["base color shift range green"])*h(e.r.sd(-1,1.2),0,1)*h(e.r.ss(.7)+e.r.ss(.7),-1,1),0,1),t[2]=h(t[2]+(null==this.cache["base color shift range blue"]?this.cache["base color shift range blue"]=Math.pow(this.randomizer.hd(0,.6,"base color shift range blue"),2):this.cache["base color shift range blue"])*h(e.r.sd(-1,1.2),0,1)*h(e.r.ss(.7)+e.r.ss(.7),-1,1),0,1)),t}getwindowcolor(e){return null==this.cache["window colors"]&&this.setupColors(),this.cache["window colors"][e.r.schoose(this.cache["window color chances"])]}}function l(e,t){return 1-t[1]/e.h}function f(e,t,c,o){var h=1;return c&&(h=Math.min(h,1-Math.abs(t[0]-e.hw)/e.hw)),o&&(h=Math.min(h,1-Math.abs(t[1]-e.hh)/e.hh)),h}function d(e,t){return f(e,t,!0,!0)*(1-1/((e.w+e.h)/1e3+1))*Math.pow(e.f.randomizer.hd(0,1,"master bigness"),.5)*(1-e.getpcdone())}function m(e,t){return[Math.min(t[0][0]-24,e.w-24-t[1][0]),Math.min(t[0][1]-24,e.h-24-t[1][1])]}function u(e,t,c,o){var r=e.cfx.createLinearGradient(c[0],c[1],2*t[0]-c[0],2*t[1]-c[1]),a=function(e){return"rgba(0,0,0,"+h(e,0,1)+")"}(o);return r.addColorStop(0,a),r.addColorStop(.5,"rgba(0,0,0,0)"),r.addColorStop(1,a),r}const g=[];g[0]=function(e,t){let c=8;var o=Math.pow(d(e,t),.3);if(e.r.sb(e.f.randomizer.hd(0,.9,"com0 bigchance"))*o)for(;e.r.sb((null==e.f.cache["com0 bigincchance"]?e.f.cache["com0 bigincchance"]=e.f.randomizer.hd(0,.5,"com0 bigincchance"):e.f.cache["com0 bigincchance"])*o);){var r=m(e,[[t[0]-c,t[1]-c],[t[0]+c,t[1]+c]]);if(!(Math.min(r[0],r[1])>.5*c))break;c*=1.5}var s=2*c,n=[Math.ceil(e.r.sd(1,Math.max(2,.5*c))),Math.ceil(e.r.sd(1,Math.max(2,.5*c)))],l=Math.min(n[0],n[1])*e.r.sd(.1,1.2),f=[n[0]+2*l,n[1]+2*l],g=[Math.ceil(s/f[0]),Math.ceil(s/f[1])],x=[Math.round(g[0]*f[0]/2),Math.round(g[1]*f[1]/2)],b=e.getpcdone(),w=e.f.getBaseColor(e),M=a(i(w,e.r.sd(.4,1))),p=a(i(w,e.r.sd(.4,1)));e.cfx.fillStyle="rgba(0,0,0,"+e.r.sd(0,.25)+")",e.cfx.fillRect(t[0]-x[0]-1,t[1]-x[1]-1,f[0]*g[0]+2,f[1]*g[1]+2),e.cfx.fillStyle=p,e.cfx.fillRect(t[0]-x[0],t[1]-x[1],f[0]*g[0],f[1]*g[1]),e.cfx.fillStyle=M;for(var v=0;v<g[0];v++)for(var z=t[0]+l+v*f[0]-x[0],y=0;y<g[1];y++){var S=t[1]+l+y*f[1]-x[1];e.cfx.fillRect(z,S,n[0],n[1])}e.r.sb(h(c/8*(.6*b+.3),0,.98))&&(e.cfx.fillStyle=u(e,t,[t[0]+x[0],t[1]],e.r.sd(0,.9)),e.cfx.fillRect(t[0]-x[0],t[1]-x[1],f[0]*g[0],f[1]*g[1]))},g[1]=function(e,t){var c=8,o=Math.pow(d(e,t),.2);if(e.r.sb((null==e.f.cache["com1 bigchance"]?e.f.cache["com1 bigchance"]=e.f.randomizer.hd(.3,1,"com1 bigchance"):e.f.cache["com1 bigchance"])*o))for(;e.r.sb((null==e.f.cache["com1 bigincchance"]?e.f.cache["com1 bigincchance"]=e.f.randomizer.hd(0,.6,"com1 bigincchance"):e.f.cache["com1 bigincchance"])*o);){var r=m(e,[[t[0]-c,t[1]-c],[t[0]+c,t[1]+c]]);if(!(Math.min(r[0],r[1])>.5*c))break;c*=1.5}var s=Math.ceil(e.r.sd(.8,2)*c),n=Math.ceil(e.r.sd(.8,2)*c),l=e.r.si(3,Math.max(4,s)),f=Math.max(1,Math.round(s/l));s=f*l;var g=a(i(e.f.getBaseColor(e),e.r.sd(.5,1))),x=e.r.sd(.3,.9);if(e.r.sb(null==e.f.cache["com1 hchance"]?e.f.cache["com1 hchance"]=h(e.f.randomizer.hd(-.2,1.2,"com1 hchance"),0,1):e.f.cache["com1 hchance"])){var b=[t[0]-Math.floor(s/2),t[1]-Math.floor(n/2)];e.cfx.fillStyle="rgba(0,0,0,"+e.r.sd(0,.25)+")",e.cfx.fillRect(b[0]-1,b[1]-1,s+2,n+2),e.cfx.fillStyle=g,e.cfx.fillRect(b[0],b[1],s,n);for(var w=0;w<f;w++)e.cfx.fillStyle=u(e,[b[0]+(w+.5)*l,t[1]],[b[0]+w*l,t[1]],x),e.cfx.fillRect(b[0]+w*l,b[1],l,n)}else{b=[t[0]-Math.floor(n/2),t[1]-Math.floor(s/2)];e.cfx.fillStyle="rgba(0,0,0,"+e.r.sd(0,.25)+")",e.cfx.fillRect(b[0]-1,b[1]-1,n+2,s+2),e.cfx.fillStyle=g,e.cfx.fillRect(b[0],b[1],n,s);for(w=0;w<f;w++)e.cfx.fillStyle=u(e,[t[0],b[1]+(w+.5)*l],[t[0],b[1]+w*l],x),e.cfx.fillRect(b[0],b[1]+w*l,s,l)}},g[2]=function(e,t){let c=8;var o=Math.pow(d(e,t),.05);if(e.r.sb((null==e.f.cache["com2 bigchance"]?e.f.cache["com2 bigchance"]=e.f.randomizer.hd(0,1,"com2 bigchance"):e.f.cache["com2 bigchance"])*o))for(;e.r.sb((null==e.f.cache["com2 bigincchance"]?e.f.cache["com2 bigincchance"]=e.f.randomizer.hd(0,.9,"com2 bigincchance"):e.f.cache["com2 bigincchance"])*o);){var r=m(e,[[t[0]-c,t[1]-c],[t[0]+c,t[1]+c]]);if(!(Math.min(r[0],r[1])>.5*c))break;c*=1.5}var s=Math.ceil(e.r.sd(.6,1.4)*c),n=Math.ceil(e.r.sd(1,2)*c),l=[Math.ceil(h(s*e.r.sd(.7,1)/2,1,s)),Math.ceil(h(s*e.r.sd(.8,1)/2,1,s))],f=[Math.floor(h(s*e.r.sd(.05,.25),1,n)),Math.floor(h(s*e.r.sd(.1,.3),1,n))],u=f[0]+f[1],g=e.r.sb(null==e.f.cache["com2 oddchance"]?e.f.cache["com2 oddchance"]=Math.pow(e.f.randomizer.hd(0,1,"com2 oddchance"),.5):e.f.cache["com2 oddchance"]),x=h(Math.floor(n/u),1,n),b=x*u+(g?f[0]:0),w=e.f.getBaseColor(e),M=[i(w,e.r.sd(.6,1)),i(w,e.r.sd(.6,1))],p=1-e.r.sd(.5,.95),v=[i(M[0],p),i(M[1],p)];if(e.r.sb(null==e.f.cache["com2 verticalchance"]?e.f.cache["com2 verticalchance"]=Math.pow(e.f.randomizer.hd(0,1,"com2 verticalchance"),.1):e.f.cache["com2 verticalchance"])){(S=[e.cfx.createLinearGradient(t[0]-l[0],t[1],t[0]+l[0],t[1]),e.cfx.createLinearGradient(t[0]-l[1],t[1],t[0]+l[1],t[1])])[0].addColorStop(0,a(v[0])),S[0].addColorStop(.5,a(M[0])),S[0].addColorStop(1,a(v[0])),S[1].addColorStop(0,a(v[1])),S[1].addColorStop(.5,a(M[1])),S[1].addColorStop(1,a(v[1]));for(var z=Math.floor(t[1]-b/2),y=0;y<x;y++)e.cfx.fillStyle=S[0],e.cfx.fillRect(t[0]-l[0],z+y*u,2*l[0],f[0]),e.cfx.fillStyle=S[1],e.cfx.fillRect(t[0]-l[1],z+y*u+f[0],2*l[1],f[1]);g&&(e.cfx.fillStyle=S[0],e.cfx.fillRect(t[0]-l[0],z+x*u,2*l[0],f[0]))}else{var S;(S=[e.cfx.createLinearGradient(t[0],t[1]-l[0],t[0],t[1]+l[0]),e.cfx.createLinearGradient(t[0],t[1]-l[1],t[0],t[1]+l[1])])[0].addColorStop(0,a(v[0])),S[0].addColorStop(.5,a(M[0])),S[0].addColorStop(1,a(v[0])),S[1].addColorStop(0,a(v[1])),S[1].addColorStop(.5,a(M[1])),S[1].addColorStop(1,a(v[1]));var C=Math.floor(t[0]-b/2);for(y=0;y<x;y++)e.cfx.fillStyle=S[0],e.cfx.fillRect(C+y*u,t[1]-l[0],f[0],2*l[0]),e.cfx.fillStyle=S[1],e.cfx.fillRect(C+y*u+f[0],t[1]-l[1],f[1],2*l[1]);g&&(e.cfx.fillStyle=S[0],e.cfx.fillRect(C+x*u,t[1]-l[0],f[0],2*l[0]))}},g[3]=function(e,t){if(e.r.sb(l(e,t)-.3)||e.getcellstate(t[0],t[1]+6*1.2)>0||e.getcellstate(t[0],t[1]+10.8)>0)for(var c=0;c<100;c++){var o=e.r.schoose(e.f.componentChances);if(3!=o)return void g[o](e,t)}let h=8;var r=Math.pow(d(e,t),.1);if(e.r.sb((null==e.f.cache["com3 bigchance"]?e.f.cache["com3 bigchance"]=e.f.randomizer.hd(.6,1,"com3 bigchance"):e.f.cache["com3 bigchance"])*r))for(;e.r.sb((null==e.f.cache["com3 bigincchance"]?e.f.cache["com3 bigincchance"]=e.f.randomizer.hd(.3,.8,"com3 bigincchance"):e.f.cache["com3 bigincchance"])*r);){var s=m(e,[[t[0]-h,t[1]-h],[t[0]+h,t[1]+h]]);if(!(Math.min(s[0],s[1])>.5*h))break;h*=1.5}var n=e.r.sd(1,2)*h,f=Math.ceil(e.r.sd(.3,1)*h),u=n*e.r.sd(.25,.6),x=(n+u)/2/2,b=[Math.max(1,Math.ceil(f*e.r.sd(.08,.25))),Math.max(1,Math.ceil(f*e.r.sd(.03,.15)))],w=b[0]+b[1],M=Math.ceil(f/w);f=M*w+b[0],e.f.setupColors();var p=e.f.cache["base colors"][null==e.f.cache["com3 basecolor"]?e.f.cache["com3 basecolor"]=e.f.randomizer.hchoose(e.f.cache["base color chances"],"com3 basecolor"):e.f.cache["com3 basecolor"]],v=null==e.f.cache["com3 lightness0 mid"]?e.f.cache["com3 lightness0 mid"]=e.f.randomizer.hd(.5,.8,"com3 lightness0 mid"):e.f.cache["com3 lightness0 mid"],z=v-(null==e.f.cache["com3 lightness0 edge"]?e.f.cache["com3 lightness0 edge"]=e.f.randomizer.hd(.2,.4,"com3 lightness0 edge"):e.f.cache["com3 lightness0 edge"]),y=null==e.f.cache["com3 lightness1 edge"]?e.f.cache["com3 lightness1 edge"]=e.f.randomizer.hd(0,.2,"com3 lightness1 edge"):e.f.cache["com3 lightness1 edge"],S=[e.cfx.createLinearGradient(t[0]-x,t[1],t[0]+x,t[1]),e.cfx.createLinearGradient(t[0]-x,t[1],t[0]+x,t[1])];S[0].addColorStop(0,a(i(p,z))),S[0].addColorStop(.5,a(i(p,v))),S[0].addColorStop(1,a(i(p,z))),S[1].addColorStop(0,a(i(p,y))),S[1].addColorStop(.5,a(p)),S[1].addColorStop(1,a(i(p,y)));var C=Math.ceil(t[1]-f/2);e.cfx.fillStyle=S[0],e.cfx.beginPath(),e.cfx.moveTo(t[0]-u/2,C),e.cfx.lineTo(t[0]+u/2,C),e.cfx.lineTo(t[0]+n/2,C+f),e.cfx.lineTo(t[0]-n/2,C+f),e.cfx.fill(),e.cfx.fillStyle=S[1];for(var P=[C+b[0],C+w],R=0;R<M;R++){var T=[R*w+b[0],(R+1)*w],_=[P[0]+R*w,P[1]+R*w];s=[(u+T[0]/f*(n-u))/2,(u+T[1]/f*(n-u))/2];e.cfx.beginPath(),e.cfx.moveTo(t[0]-s[0],_[0]),e.cfx.lineTo(t[0]+s[0],_[0]),e.cfx.lineTo(t[0]+s[1],_[1]),e.cfx.lineTo(t[0]-s[1],_[1]),e.cfx.fill()}},g[4]=function(e,t){var c=f(e,t,!0,!1),o=e.r.sd(.7,1),h=e.r.sd(0,.2),r=e.f.getBaseColor(e),s=a(i(r,o)),n=a(i(r,h));null==e.f.cache["com4 directionc"]&&(e.f.cache["com4 directionc"]=[1*Math.pow(e.f.randomizer.hd(0,1,"com4 directionc0"),4),.1*Math.pow(e.f.randomizer.hd(0,1,"com4 directionc1"),4),.2*Math.pow(e.f.randomizer.hd(0,1,"com4 directionc2"),4)]);var l=Math.max(3,Math.ceil(e.size*Math.pow(e.r.sd(.4,1),2)*(null==e.f.cache["com4 maxwidth"]?e.f.cache["com4 maxwidth"]=e.f.randomizer.hd(.02,.1,"com4 maxwidth"):e.f.cache["com4 maxwidth"]))),d=Math.floor(l/2),m=l%2,u=e.r.schoose([e.f.cache["com4 directionc"][0]*(2-c),e.f.cache["com4 directionc"][1],e.f.cache["com4 directionc"][2]*(1+c)]),x=null;if(0==u){var b=t[1]-24,w=Math.min(Math.max(8,b-e.r.si(0,16)),Math.floor(.7*e.size*Math.pow(e.r.sd(0,1),null==e.f.cache["com4 hpower0"]?e.f.cache["com4 hpower0"]=e.f.randomizer.hd(2,6,"com4 hpower0"):e.f.cache["com4 hpower0"]))),M=[[t[0]-d,t[1]-w],[t[0]+d+m,t[1]]];(p=e.cfx.createLinearGradient(M[0][0],M[0][1],M[1][0],M[0][1])).addColorStop(0,n),p.addColorStop(.5,s),p.addColorStop(1,n),e.cfx.fillStyle=p,e.cfx.fillRect(M[0][0],M[0][1],l,w),x=[t[0],t[1]-w]}else if(1==u){b=e.h-(24+t[1]),w=Math.min(Math.max(8,b-e.r.si(0,16)),Math.floor(.6*e.size*Math.pow(e.r.sd(0,1),null==e.f.cache["com4 hpower1"]?e.f.cache["com4 hpower1"]=e.f.randomizer.hd(2,7,"com4 hpower1"):e.f.cache["com4 hpower1"]))),M=[[t[0]-d,t[1]],[t[0]+d+m,t[1]+w]];(p=e.cfx.createLinearGradient(M[0][0],M[0][1],M[1][0],M[0][1])).addColorStop(0,n),p.addColorStop(.5,s),p.addColorStop(1,n),e.cfx.fillStyle=p,e.cfx.fillRect(M[0][0],M[0][1],l,w),x=[t[0],t[1]+w]}else if(2==u){var p;(p=e.cfx.createLinearGradient(t[0],t[1]-d,t[0],t[1]+d+m)).addColorStop(0,n),p.addColorStop(.5,s),p.addColorStop(1,n),e.cfx.fillStyle=p,e.cfx.fillRect(t[0],t[1]-d,Math.ceil(e.hw-t[0])+1,l),x=[Math.floor(e.hw),t[1]+w]}if(null==e.f.cache["com4 covercomc"]&&(e.f.cache["com4 covercomc"]=[.6*Math.pow(e.f.randomizer.hd(0,1,"com4 covercomc0"),2),.2*Math.pow(e.f.randomizer.hd(0,1,"com4 covercomc1"),2),1*Math.pow(e.f.randomizer.hd(0,1,"com4 covercomc2"),2)]),g[e.r.schoose(e.f.cache["com4 covercomc"])](e,t),e.getcellstate(x[0],x[1])>0){var v=[x[0]+Math.round(6*e.r.sd(-1,1)),x[1]+Math.round(6*e.r.sd(-1,1))];e.getcellstate(v[0],v[1])>0?g[e.r.schoose(e.f.cache["com4 covercomc"])](e,v):g[e.r.schoose(e.f.cache["com4 covercomc"])](e,x)}},g[5]=function(e,t){let c=8;var o=Math.pow(d(e,t),.1);if(e.r.sb((null==e.f.cache["com5 bigchance"]?e.f.cache["com5 bigchance"]=e.f.randomizer.hd(0,.9,"com5 bigchance"):e.f.cache["com5 bigchance"])*o))for(;e.r.sb((null==e.f.cache["com5 bigincchance"]?e.f.cache["com5 bigincchance"]=e.f.randomizer.hd(0,.8,"com5 bigincchance"):e.f.cache["com5 bigincchance"])*o);){var h=m(e,[[t[0]-c,t[1]-c],[t[0]+c,t[1]+c]]);if(!(Math.min(h[0],h[1])>.5*c))break;c*=1.5}var r=e.r.sd(.75,1),s=e.r.sd(0,.25),n=e.f.getBaseColor(e),l=a(i(n,r)),f=a(i(n,s)),u=1+e.r.sseq(null==e.f.cache["com5 multxc"]?e.f.cache["com5 multxc"]=e.f.randomizer.hd(0,1,"com5 multxc"):e.f.cache["com5 multxc"],Math.floor(1.2*Math.pow(c/8,.6))),g=1+e.r.sseq(null==e.f.cache["com5 multyc"]?e.f.cache["com5 multyc"]=e.f.randomizer.hd(0,1,"com5 multyc"):e.f.cache["com5 multyc"],Math.floor(1.2*Math.pow(c/8,.6))),x=e.r.sd(.5,1)*c/Math.max(u,g),b=x+.5,w=x+1,M=.2*x,p=x*u,v=x*g,z=[t[0]-p,t[1]-v];e.cfx.fillStyle="rgba(0,0,0,"+e.r.sd(0,.2)+")";for(var y=0;y<u;y++)for(var S=z[0]+(2*y+1)*x,C=0;C<g;C++){var P=z[1]+(2*C+1)*x;e.cfx.beginPath(),e.cfx.arc(S,P,w,0,2*Math.PI),e.cfx.fill()}for(y=0;y<u;y++)for(S=z[0]+(2*y+1)*x,C=0;C<g;C++){P=z[1]+(2*C+1)*x;var R=e.cfx.createRadialGradient(S,P,M,S,P,b);R.addColorStop(0,l),R.addColorStop(1,f),e.cfx.fillStyle=R,e.cfx.beginPath(),e.cfx.arc(S,P,b,0,2*Math.PI),e.cfx.fill()}},g[6]=function(e,t){if(e.nextpass<=0||e.r.sb(l(e,t)))return void g[e.r.schoose(function(e,t,c){const o=new Array(c-t);for(let h=c;h>=t;h--)o[h-t]=e[h];return o}(e.f.componentChances,0,5))](e,t);let c=8;var o=Math.pow(d(e,t),.05);if(e.r.sb((null==e.f.cache["com6 bigchance"]?e.f.cache["com6 bigchance"]=e.f.randomizer.hd(0,.9,"com6 bigchance"):e.f.cache["com6 bigchance"])*o))for(;e.r.sb((null==e.f.cache["com6 bigincchance"]?e.f.cache["com6 bigincchance"]=e.f.randomizer.hd(0,.8,"com6 bigincchance"):e.f.cache["com6 bigincchance"])*o);){var h=m(e,[[t[0]-c,t[1]-c],[t[0]+c,t[1]+c]]);if(!(Math.min(h[0],h[1])>.5*c))break;c*=1.5}var r=Math.ceil(2*c*e.r.sd(.6,1)),s=Math.floor(r/2),n=r%2,f=r*Math.pow(e.r.sd(null==e.f.cache["com6 h1min"]?e.f.cache["com6 h1min"]=Math.pow(e.f.randomizer.hd(0,.8,"com6 h1min"),.5):e.f.cache["com6 h1min"],.9),null==e.f.cache["com6 h1power"]?e.f.cache["com6 h1power"]=e.f.randomizer.hd(.5,1.5,"com6 h1power"):e.f.cache["com6 h1power"]),u=Math.floor(f/2),x=r%2,b=Math.max(0-(r-f)/2,r*(e.r.sd(0,.45)+e.r.sd(0,.45))*(null==e.f.cache["com6 backness"]?e.f.cache["com6 backness"]=e.f.randomizer.hb(.8,"com6 backnesstype")?e.f.randomizer.hd(.2,.9,"com6 backness#pos"):e.f.randomizer.hd(-.2,-.05,"com6 backness#neg"):e.f.cache["com6 backness"])),w=Math.ceil(c*e.r.sd(.7,1)*(null==e.f.cache["com6 width"]?e.f.cache["com6 width"]=Math.pow(e.f.randomizer.hd(.1,3.5,"com6 width"),.5):e.f.cache["com6 width"])),M=Math.floor(w/2),p=w%2,v=[[t[0]-M,t[1]+b-u],[t[0]+M+p,t[1]-s],[t[0]+M+p,t[1]+s+n],[t[0]-M,t[1]+b+u+x]],z=e.f.getBaseColor(e);e.cfx.fillStyle="rgba(0,0,0,"+e.r.sd(0,.2)+")",e.cfx.beginPath(),e.cfx.moveTo(v[0][0]-1,v[0][1]),e.cfx.lineTo(v[1][0]-1,v[1][1]),e.cfx.lineTo(v[2][0]-1,v[2][1]),e.cfx.lineTo(v[3][0]-1,v[3][1]),e.cfx.fill(),e.cfx.fillStyle=a(i(z,e.r.sd(.7,1))),e.cfx.beginPath(),e.cfx.moveTo(v[0][0],v[0][1]),e.cfx.lineTo(v[1][0],v[1][1]),e.cfx.lineTo(v[2][0],v[2][1]),e.cfx.lineTo(v[3][0],v[3][1]),e.cfx.fill()};const x=[];x[0]=function(e){var t=.05*((e.w-48)*(e.h-48)),c=Math.ceil((e.w-48)*(null==e.f.cache["outline0 iw"]?e.f.cache["outline0 iw"]=e.f.randomizer.hd(.1,1,"outline0 iw"):e.f.cache["outline0 iw"])*.2),o=[[[e.hw-c,24],[e.hw+c,e.h-24]]];null==e.f.cache["outline0 bc"]&&(e.f.cache["outline0 bc"]=e.f.randomizer.hd(2,8,"outline0 bc"));for(var r=2+Math.floor(e.r.sd(.5,1)*e.f.cache["outline0 bc"]*Math.sqrt(e.size)),a=1;a<r;a++){var i=o[e.r.si(0,o.length-1)],s=[i[0][0]+e.r.sd(0,1)*(i[1][0]-i[0][0]),i[0][1]+e.r.sd(0,1)*(i[1][1]-i[0][1])];s[1]<.5*(i[0][1]+i[1][1])&&e.r.sb(null==e.f.cache["outline0 frontbias"]?e.f.cache["outline0 frontbias"]=e.f.randomizer.hd(.5,1.5,"outline0 frontbias"):e.f.cache["outline0 frontbias"])&&(s[1]=i[1][1]-(s[1]-i[0][1]));var n=[h(e.r.sd(0,1)*e.w,24,e.w-24),h(e.r.sd(0,1)*e.h,24,e.h-24)],l=t/Math.abs((n[0]-s[0])*(n[1]-s[1]));if(l<1&&(n[0]=s[0]+(n[0]-s[0])*l,n[1]=s[1]+(n[1]-s[1])*l),s[0]>n[0]){var f=s[0];s[0]=n[0],n[0]=f}if(s[1]>n[1]){f=s[1];s[1]=n[1],n[1]=f}o.push([[Math.floor(s[0]),Math.floor(s[1])],[Math.ceil(n[0]),Math.ceil(n[1])]])}e.csx.fillStyle="#FFFFFF";for(a=0;a<o.length;a++){var d=o[a];e.csx.fillRect(d[0][0],d[0][1],d[1][0]-d[0][0],d[1][1]-d[0][1]),e.csx.fillRect(e.w-d[1][0],d[0][1],d[1][0]-d[0][0],d[1][1]-d[0][1])}},x[1]=function(e){for(var t=.05*((e.w-48)*(e.h-48)),c=Math.max(2,Math.sqrt(t/Math.PI)),o=Math.ceil((e.w-48)*(null==e.f.cache["outline1 iw"]?e.f.cache["outline1 iw"]=e.f.randomizer.hd(.1,1,"outline1 iw"):e.f.cache["outline1 iw"])*.2),h=[],r=Math.floor((e.h-48)/(2*o)),a=0;a<r;a++){let t=[e.hw,e.h-(24+o*(2*a+1))];h.push({v:t,r:o})}null==e.f.cache["outline1 cc"]&&(e.f.cache["outline1 cc"]=e.f.randomizer.hd(10,50,"outline1 cc"));var i=r+Math.floor(e.r.sd(.5,1)*e.f.cache["outline1 cc"]*Math.sqrt(e.size));for(a=r;a<i;a++){var s=h[Math.max(e.r.si(0,h.length-1),e.r.si(0,h.length-1))],n=e.r.sd(1,c),l=e.r.sd(Math.max(0,s.r-n),s.r);if((f=e.r.sd(0,2*Math.PI))>Math.PI&&e.r.sb(null==e.f.cache["outline1 frontbias"]?e.f.cache["outline1 frontbias"]=e.f.randomizer.hd(.5,1.5,"outline1 frontbias"):e.f.cache["outline1 frontbias"]))var f=e.r.sd(0,Math.PI);let t=[s.v[0]+Math.cos(f)*l,s.v[1]+Math.sin(f)*l];n=Math.min(n,t[0]-24),n=Math.min(n,e.w-24-t[0]),n=Math.min(n,t[1]-24),n=Math.min(n,e.h-24-t[1]),h.push({v:t,r:n})}e.csx.fillStyle="#FFFFFF";for(let t=0;t<h.length;t++){const c=h[t];e.csx.beginPath(),e.csx.arc(c.v[0],c.v[1],c.r,0,2*Math.PI),e.csx.fill(),e.csx.beginPath(),e.csx.arc(e.w-c.v[0],c.v[1],c.r,0,2*Math.PI),e.csx.fill()}},x[2]=function(e){var t=[e.w-48,e.h-48],c=[[e.hw,e.r.sd(0,.05)*t[1]+24],[e.hw,e.r.sd(.95,1)*t[1]+24]],o=6/e.size+(null==e.f.cache["outline2 basefatness"]?e.f.cache["outline2 basefatness"]=e.f.randomizer.hd(.03,.1,"outline2 basefatness"):e.f.cache["outline2 basefatness"]),h=1/o,r=Math.max(3,Math.ceil(h*e.r.sd(.05,.1)*Math.sqrt(e.size)));e.csx.lineCap=["round","square"][null==e.f.cache["outline2 linecap"]?e.f.cache["outline2 linecap"]=e.f.randomizer.hi(0,1,"outline2 linecap"):e.f.cache["outline2 linecap"]],e.csx.strokeStyle="#FFFFFF";for(var a=1;a<r;a++){var i=c[a];null==i&&(i=[e.r.sd(0,1)*t[0]+24,Math.pow(e.r.sd(0,1),null==e.f.cache["outline2 frontbias"]?e.f.cache["outline2 frontbias"]=e.f.randomizer.hd(.1,1,"outline2 frontbias"):e.f.cache["outline2 frontbias"])*t[1]+24],c.push(i));for(var s=1+e.r.sseq(null==e.f.cache["outline2 conadjust"]?e.f.cache["outline2 conadjust"]=e.f.randomizer.hd(0,1,"outline2 conadjust"):e.f.cache["outline2 conadjust"],3),n=0;n<s;n++){var l=c[e.r.si(0,c.length-2)];e.csx.lineWidth=e.r.sd(.7,1)*o*e.size,e.csx.beginPath(),e.csx.moveTo(l[0],l[1]),e.csx.lineTo(i[0],i[1]),e.csx.stroke(),e.csx.beginPath(),e.csx.moveTo(e.w-l[0],l[1]),e.csx.lineTo(e.w-i[0],i[1]),e.csx.stroke()}}};class b{constructor(e,t){this.extradone=0,this.nextpass=0,this.nextcell=0,this.totaldone=0,this.f=e,this.baseSeed=t,this.seed=this.f.seed+this.baseSeed,this.r=new o(this.seed),this.size=Math.pow(this.r.sd(this.f.randomizer.hd(2.5,3.5,"size min"),this.f.randomizer.hd(5,7,"size max")),3);const c=this.r.sd(this.f.randomizer.hd(.5,1,"wratio min"),this.f.randomizer.hd(1,1.3,"wratio max")),h=this.r.sd(this.f.randomizer.hd(.7,1,"hratio min"),this.f.randomizer.hd(1.1,1.7,"hratio max"));this.w=Math.floor(this.size*c)+48,this.hw=Math.floor(this.w/2),this.gw=Math.floor((this.w-48)/6),this.gwextra=.5*(this.w-6*this.gw),this.h=Math.floor(this.size*h)+48,this.hh=Math.floor(this.h/2),this.gh=Math.floor((this.h-48)/6),this.ghextra=.5*(this.h-6*this.gh),this.cs=document.createElement("canvas"),this.cs.setAttribute("width",String(this.w)),this.cs.setAttribute("height",String(this.h)),this.csx=this.cs.getContext("2d"),this.cf=document.createElement("canvas"),this.cf.setAttribute("width",String(this.w)),this.cf.setAttribute("height",String(this.h)),this.cfx=this.cf.getContext("2d"),x[this.f.randomizer.hchoose([1,1,1],"outline type")](this),this.csd=this.csx.getImageData(0,0,this.w,this.h),this.cgrid=[];for(var r=0;r<this.gw;r++){this.cgrid[r]=[];for(var a=0;a<this.gh;a++)this.cgrid[r][a]={gx:r,gy:a,x:Math.floor(this.gwextra+6*(r+.5)),y:Math.floor(this.ghextra+6*(a+.5)),state:0}}this.goodcells=[this.cgrid[Math.floor(this.gw/2)][Math.floor(this.gh/2)]];for(var i=0;i<this.goodcells.length;){var s;if((l=this.goodcells[i]).gx>0)0==(s=this.cgrid[l.gx-1][l.gy]).state&&(this.getspa(s.x,s.y)>0?(s.state=1,this.goodcells.push(s)):s.state=-1);if(l.gx<this.gw-1)0==(s=this.cgrid[l.gx+1][l.gy]).state&&(this.getspa(s.x,s.y)>0?(s.state=1,this.goodcells.push(s)):s.state=-1);if(l.gy>0)0==(s=this.cgrid[l.gx][l.gy-1]).state&&(this.getspa(s.x,s.y)>0?(s.state=1,this.goodcells.push(s)):s.state=-1);if(l.gy<this.gh-1)0==(s=this.cgrid[l.gx][l.gy+1]).state&&(this.getspa(s.x,s.y)>0?(s.state=1,this.goodcells.push(s)):s.state=-1);i++}for(var n=0;n<this.goodcells.length;n++){var l=this.goodcells[n],f=this.cgrid[this.gw-1-l.gx][l.gy];1!=f.state&&(f.state=1,this.goodcells.push(f))}this.passes=this.f.randomizer.hi(1,2,"base component passes"),this.extra=Math.max(1,Math.floor(this.goodcells.length*this.f.randomizer.hd(0,1/this.passes,"extra component amount"))),this.totalcomponents=this.passes*this.goodcells.length+this.extra}getcell(e,t){var c=Math.floor((e-this.gwextra)/6),o=Math.floor((t-this.ghextra)/6);return c<0||c>=this.gw||o<0||o>=this.gh?null:this.cgrid[c][o]}getcellstate(e,t){var c=this.getcell(e,t);return null==c?0:c.state}getspa(e,t){return e=Math.floor(e),t=Math.floor(t),e<0||e>this.w||t<0||t>this.h?-1:this.csd.data[4*(t*this.w+e)+3]}getpcdone(){return this.totaldone/this.totalcomponents}addcomponent(){var e;if(this.nextpass<this.passes)this.nextcell<this.goodcells.length?(e=this.goodcells[this.nextcell],this.nextcell++):(this.nextpass++,e=this.goodcells[0],this.nextcell=1);else{if(!(this.extradone<this.extra))return!0;e=this.goodcells[this.r.si(0,this.goodcells.length-1)],this.extradone++}for(var t=[e.x,e.y],c=0;c<10;c++){var o=[e.x+this.r.si(-6,6),e.y+this.r.si(-6,6)];if(!(o[0]<24||o[0]>this.w-24||o[1]<24||o[1]>this.h-24)&&!(this.getspa(o[0],o[1])<=0)){t=o;break}}return Math.abs(t[0]-this.hw)<6&&this.r.sb(this.f.randomizer.hd(0,1,"com middleness"))&&(t[0]=Math.floor(this.hw)),g[this.r.schoose(this.f.componentChances)](this,t),this.totaldone++,!1}}function w(e){for(var t=1206170165,c=e.length-1;c>=0;c--){var o=e.charCodeAt(c);t=(t<<5)+t^o^t<<o%13+1^t>>o%17+1}return t>>>0}function M(e,t,c){return null==c?Math.floor(e+Math.random()*(t-e+1)):Math.floor(e+function(e){return(4294967296*w("."+e)+w(e))/0x10000000000000000}(c)*(t-e+1))}var p="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";function v(e,t){for(var c="",o=0;o<e;o++)c+=p[M(0,p.length-1,t+"_"+o)];return c}var z=null;function y(e,t){return z=new b(new n(e),t),function(){if(null!=z){var e=!1;do{e=z.addcomponent()}while(!e);z.cfx.clearRect(z.hw+z.w%2,0,z.w,z.h),z.cfx.scale(-1,1),z.cfx.drawImage(z.cf,0-z.w,0)}}(),z}function S(e){return y(e,v(16,"_"+Math.random()))}function C(){return S(v(16,"_"+Math.random()))}}])}));